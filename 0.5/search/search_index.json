{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"BookOps-Worldcat Overview Requires Python 3.7 and up. Bookops-Worldcat is a Python wrapper around OCLC's Worldcat Metadata API which supports changes released in the version 1.1 (May 2020) of the web service. The package features methods that utilize search functionality of the API as well as read-write endpoints . The Bookops-Worldcat package simplifies some of the OCLC API boilerplate, and ideally lowers the technological threshold for cataloging departments that may not have sufficient programming support to access and utilize those web services. Python language, with its gentle learning curve, has the potential to be a perfect vehicle towards this goal. This package takes advantage of the functionality of the popular Requests library . Interaction with OCLC's services is built around Requests sessions. MetadataSession inherits all requests.Session properties. Returned server responses are requests.Response objects with all of their properties and methods . Authorizing a session simply requires passing an access token into MetadataSession . Opening a session allows the user to call specific methods which facilitate communication between the user's script/client and a particular endpoint of OCLC's service. Many of the hurdles related to making valid requests are hidden under the hood of this package, making it as simple as possible to access the functionalities of OCLC APIs. Please note, not all features of the Metadata API are implemented because this tool was primarily built for our organization's specific needs. However, we are open to any collaboration to expand and improve the package. Supported OCLC web services: At the moment, the wrapper supports only OAuth 2.0 endpoints and flows . The specific protocols are Client Credential Grant and Access Token for authorization. Worldcat Metadata API is a read-write service for WorldCat. It allows adding and updating records in WorldCat, maintaining holdings, and working with local bibliographic data. Access to Metadata API requires OCLC credentials. The BookOps wrapper focuses on the following API operations: Search functionality Find member shared print holdings ( /bibs-retained-holdings ) Get summary of holdings for known items ( /bibs-summary-holdings ) Brief bibliographic resources: Search brief bibliographic resources ( /brief-bibs ) Retrieve specific brief bibliographic resource ( /brief-bibs/{oclcNumber} ) Retrieve other editions related to a particular bibliographic resource ( /brief-bibs/{oclcNumber}/other-editions ) Full bibliographic resources Retrieve full bibliographic record ( /bib-data ) Get current OCLC number ( /bib/checkcontrolnumber ) Holdings Set and unset institution holding ( /ih/data ) Retrieve status of institution holdings ( /ih/checkholdings ) Set and unset institution holdings for a batch or records ( /ih/datalist ) Set and unset holdings for a single record for multiple intitutions ( /ih/institutionlist ) Installation To install use pip: $ pip -m install bookops-worldcat Quickstart Worldcat Metadata API requires OCLC credentials which can be obtained at the OCLC Developer Network site. Obtaining Access Token The Worldcat access token can be obtained by passing credential parameters into the WorldcatAccessToken object. >>> from bookops_worldcat import WorldcatAccessToken >>> token = WorldcatAccessToken( key=\"my_WSKey\", secret=\"my_secret\", scopes=[\"WorldCatMetadataAPI\"], principal_id=\"my_principal_id\", principlal_idns=\"my_principal_idns\" ) >>> print(token) \"access_token: 'tk_Yebz4BpEp9dAsghA7KpWx6dYD1OZKWBlHjqW', expires_at: '2020-01-01 17:19:58Z'\" >>> print(token.is_expired()) False Created token object can be directly passed into MetadataSession to authorize requests to the Metadata API web service: >>> from bookops_worldcat import MetadataSession >>> session = MetadataSession(authorization=token) Searching Brief Bibliographic Records Using Metadata API The MetadataSession is authenticated using the WorldcatAccessToken object. The session allows searching brief records as well as retrieving full bibs in the MARC XML format. Basic usage: from bookops_worldcat import MetadataSession with MetadataSession(authorization=token) as session: results = session.search_brief_bibs(q=\"ti:zendegi AND au:greg egan\") print(results.json()) Returned brief bibliographic records are in the JSON format that can be parsed via .json() method. { \"numberOfRecords\": 24, \"briefRecords\": [ { \"oclcNumber\": \"430840771\", \"title\": \"Zendegi\", \"creator\": \"Greg Egan\", \"date\": \"2010\", \"language\": \"eng\", \"generalFormat\": \"Book\", \"specificFormat\": \"PrintBook\", \"edition\": \"First edition.\", \"publisher\": \"Night Shade Books\", \"mergedOclcNumbers\": [ \"664026825\" ], \"catalogingInfo\": { \"catalogingAgency\": \"BTCTA\", \"transcribingAgency\": \"DLC\" } }, { \"oclcNumber\": \"961162511\", \"title\": \"Zendegi\", \"creator\": \"Greg Egan\", \"date\": \"2013\", \"language\": \"eng\", \"generalFormat\": \"AudioBook\", \"specificFormat\": \"CD\", \"publisher\": \"Audible Studios on Brilliance Audio\", \"mergedOclcNumbers\": [ \"947806980\" ], \"catalogingInfo\": { \"catalogingAgency\": \"AU@\", \"transcribingAgency\": \"AU@\" } }, ] } Retrieving Full Bibliographic Records To retrieve a full bibliographic record from WorldCat use the .get_full_bib method. The server returns records in MARC XML format by default. from bookops_worldcat import MetadataSession with MetadataSession(authorization=token) as session: results = session.get_full_bib(oclcNumber=430840771) print(results.text) <?xml version=\"1.0\" encoding=\"UTF-8\"?> <entry xmlns=\"http://www.w3.org/2005/Atom\"> <content type=\"application/xml\"> <response xmlns=\"http://worldcat.org/rb\" mimeType=\"application/vnd.oclc.marc21+xml\"> <record xmlns=\"http://www.loc.gov/MARC21/slim\"> <leader>00000cam a2200000 i 4500</leader> <controlfield tag=\"001\">on1143317889</controlfield> <controlfield tag=\"003\">OCoLC</controlfield> <controlfield tag=\"005\">20200328101446.1</controlfield> <controlfield tag=\"008\">200305t20202019nyuabf b 001 0 eng c</controlfield> <datafield tag=\"010\" ind1=\" \" ind2=\" \"> <subfield code=\"a\"> 2018957420</subfield> </datafield> <datafield tag=\"040\" ind1=\" \" ind2=\" \"> <subfield code=\"a\">NYP</subfield> <subfield code=\"b\">eng</subfield> <subfield code=\"e\">rda</subfield> <subfield code=\"c\">NYP</subfield> <!--...--> <datafield tag=\"020\" ind1=\" \" ind2=\" \"> <subfield code=\"a\">9780316230049</subfield> <subfield code=\"q\">(pbk.)</subfield> <!--...--> <datafield tag=\"100\" ind1=\"1\" ind2=\" \"> <subfield code=\"a\">Christakis, Nicholas A.,</subfield> <subfield code=\"e\">author.</subfield> </datafield> <datafield tag=\"245\" ind1=\"1\" ind2=\"0\"> <subfield code=\"a\">Blueprint :</subfield> <subfield code=\"b\">the evolutionary origins of a good society /</subfield> <subfield code=\"c\">Nicholas A. Christakis.</subfield> </datafield> <datafield tag=\"250\" ind1=\" \" ind2=\" \"> <subfield code=\"a\">First Little, Brown Spark trade paperback edition.</subfield> </datafield> <datafield tag=\"264\" ind1=\" \" ind2=\"1\"> <subfield code=\"a\">New York, NY :</subfield> <subfield code=\"b\">Little, Brown Spark,</subfield> <subfield code=\"c\">2020</subfield> </datafield> <!--...--> </record> </response> </content> <id>http://worldcat.org/oclc/1143317889</id> <link href=\"http://worldcat.org/oclc/1143317889\"></link> </entry> Updating Holdings MetadataSession can be used to check or set/unset your library holdings on a master record in Worldcat: example: result = session.holding_set(oclc_number=\"850939579\") print(result) <Response [201]> result = session.holding_get_status(\"850939579\") print(result.json()) { \"title\": \"850939579\", \"content\": { \"requestedOclcNumber\": \"850939579\", \"currentOclcNumber\": \"850939579\", \"institution\": \"NYP\", \"holdingCurrentlySet\": true, \"id\": \"http://worldcat.org/oclc/850939579\" }, \"updated\": \"2020-10-01T04:10:13.017Z\" } For holdings operations on batches of records see Advanced Usage>MetadataSession>Updating Holdings Advanced Usage Identifying your application BookOps-Worldcat provides a default user-agent value in headers of all requests to OCLC web services: bookops-worldcat/{version} . It is encouraged to update the user-agent value to properly identify your application to OCLC servers. This will provide a useful piece of information for OCLC staff if they need to assist with troubleshooting problems that may arise. To set a custom \"user-agent\" in a session simply pass is as an argument when initiating the session: session = MetadataSession(authorization=token, agent=\"my_client_name\") ... or simply update its headers attribute: session.headers.update({\"user-agent\": \"my-app/version 1.0\"}) The user-agent header can be set for an access token request as well. To do that simply pass it as the agent parameter when initiating WorldcatAccessToken object: token = WorldcatAccessToken( key=\"my_WSKey\", secret=\"my_secret\", scopes=[\"WorldCatMetadataAPI\"], principal_id=\"my_principal_id\", principlal_idns=\"my_principal_idns\", agent=\"my_app/1.0.0\" ) Event hooks MetadataSession methods support Requests event hooks which can be passed as an argument: def print_url(response, *args, **kwargs): print(response.url) hooks = {'response': print_url} session.get_brief_bib(850939579, hooks=hooks) WorldcatAccessToken Bookops-Worldcat utilizes OAuth 2.0 and Client Credential Grant flow to acquire Access Token. Please note, your OCLC credentials must allow access to the Metadata API in their scope to be permitted to make requests to the web service. Obtaining: from bookops_worldcat import WorldcatAccessToken token = WorldcatAccessToken( key=\"my_WSKey\", secret=\"my_secret\", scopes=[\"WorldCatMetadataAPI\"], principal_id=\"my_principal_id\", principlal_idns=\"my_principal_idns\", agent=\"my_app/version 1.0\" ) Token object retains underlying Requests object functionality ( requests.Request ) that can be accessed via the .server_response attribute: print(token.server_response.status_code) 200 print(token.server_response.elapsed): 0:00:00.650108 print(token.server_response.json()) { \"user-agent\": \"bookops-worldcat/0.1.0\", \"Accept-Encoding\": \"gzip, deflate\", \"Accept\": \"application/json\", \"Connection\": \"keep-alive\", \"Content-Length\": \"67\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic encoded_authorization_here=\" } Checking if the token has expired can be done by calling the is_expired method: print(token.is_expired()) True A failed token request raises WorldcatAuthorizationError which provides a returned by the server error code and detailed message. MetadataSession A wrapper around WorldCat Metadata API. MetadataSession inherits requests.Session methods. Returned full bibliographic records are by default in MARC/XML format, but it is possible to receive OCLC's native CDF XML and the CDF translation into JSON serializations by supplying appropriate values in the response_format argument to the get_full_bib method. Search endpoints of the Metadata API return responses serialized into JSON format only. All MetadataSession issued requests have a build-in access token auto-refresh feature. While a session is open, before any request is sent, a current token is checked for expiration and if needed a new access token is automatically obtained. OCLC numbers in methods' arguments MetadataSession accepts OCLC numbers in methods' arguments as integers or strings with or without a prefix (\"ocm\", \"ocn\", \"on\"). The following are all acceptable: session.get_brief_bib(oclcNumber=\"ocm00012345\") session.get_brief_bib(oclcNumber=\"00012345\") session.get_brief_bib(oclcNumber=12345) session.search_current_control_numbers(oclcNumbers=[\"ocm00012345\", \"00012346\", 12347]) Search Functionality MetadataSession supports the following search functionality: get_brief_bib retrieves a specific brief bibliographic resource search_brief_bib_other_editions retrieves other editions related to a bibliographic resource specified with an OCLC # search_brief_bibs retrieves brief resouces for a keyword or a fielded query search_current_control_numbers retrieves current OCLC control numbers search_general_holdings retrieves a summary of holdings for a specified item search_shared_print_holdings finds member library holdings with a commitment to retain (Shared Print) The server responses are returned in JSON format by default. Obtaining brief record with MetadataSession(authorization=token) as session: result = session.get_brief_bib(850940548) print(results.json()) { \"oclcNumber\": \"850940548\", \"title\": \"Record Builder Added This Test Record On 06/26/2013 13:07:06.\", \"creator\": \"OCLC RecordBuilder.\", \"date\": \"2012\", \"language\": \"eng\", \"generalFormat\": \"Book\", \"specificFormat\": \"PrintBook\", \"catalogingInfo\": { \"catalogingAgency\": \"OCPSB\", \"transcribingAgency\": \"OCPSB\" } } Quering WorldCat Metadata API provides quite robust methods to query WorldCat. In addition to a flexible query string that supports keyword and fielded searches, it is possibile to set further limits using various elements such as type of item, language, publishing date, etc. It is possible to specify the order of returned records by using the orderBy argument. Results are returned as brief records in JSON format. The query syntax is case-insensitive and allows keyword and phrase search (use quotation marks), boolean operators (AND, OR, NOT), wildcards (# - single character, ? - any number of additional characters), and truncation (use * character). keyword search with item type, language, and publishing date limiters: session.search_brief_bibs( q=\"czarne oceany dukaj\", itemType=\"book\", inLanguage=\"pol\", datePublished=\"2015-2020\" orderBy=\"publicationDateDesc\" ) fielded query: session.search_brief_bibs( q='ti=\"czarne oceany\" AND au:jacek dukaj AND ge=\"science fiction\"') More about the query syntax can be found in OCLC documentation Obtaining Full Bibliographic Records session.get_full_bib() method with OCLC number as an argument sends a request for a matching full bibliographic record in WorldCat. The Metadata API correctly matches requested OCLC numbers of records that have been merged together by returning the current master record. By default get_full_bib returns records in MARC XML format. Returned response is a requests.Response object with all its features: with MetadataSession(authorization=token) as session: result = session.get_full_bib(\"00000000123\") print(result.status_code) print(result.url) 200 \"https://worldcat.org/bib/data/00000000123\" To avoid any UnicodeEncodeError it is recommended to access retrieved data with .content attribute of the response object: print(response.content) Retrieving Current OCLC Number MetadataSession.search_current_control_numbers method allows retrieval of a current control number of the master record in WorldCat. Occasionally, records identified as duplicates in WorldCat have been merged. In that case a local control number may not correctly refer to an OCLC master record. Returned responses are in JSON format by default, but it's possible to pass 'application/atom+xml' in the response_format argument to have the response serialized into xml. search_current_control_numbers method accepts control numbers as a list or a comma separated string: session.search_current_control_numbers(oclcNumbers=\"00012345,00012346,00012347\") session.search_current_control_numbers(oclcNumbers=[12345, 12346, 12347], response_format=\"application/atom+xml\") Holdings MetadataSession supports the following holdings operations: holding_get_status retrieves holding status of a requested record holding_set sets holding on an individual bibliographic record holding_unset deletes holding on an individual bibliographic record holdings_set allows holdings to be set on multiple records, and is not limited by OCLC's 50 bib record limit holdings_unset allows holdings to be deleted on multiple records, and is not limited to OCLC's 50 bib record restriction holdings_set_multi_institutions allows to set holdings for a single record for multiple institutions holdings_unset_multi_institutions deletes holdings on a single record for multiple institutions By default, responses are returned in atom+json format, but atom+xml can be specified: result = session.holding_get_status(oclcNumber=\"ocn123456789\", response_format=\"application/atom+xml\") print(result.text) <?xml version=\"1.0\" encoding=\"UTF-8\"?> <entry xmlns=\"http://www.w3.org/2005/Atom\"> <title type=\"text\">1143317889</title> <updated>2020-04-25T05:21:10.233Z</updated> <content type=\"application/xml\"> <holdings xmlns=\"http://worldcat.org/metadata-api-service\"> <requestedOclcNumber>1143317889</requestedOclcNumber> <currentOclcNumber>1143317889</currentOclcNumber> <institution>NYP</institution> <holdingCurrentlySet>true</holdingCurrentlySet> <id>http://worldcat.org/oclc/1143317889</id> </holdings> </content> </entry> Pass OCLC record numbers for batch operations as a list of strings or integers or comma separated string with or without a prefix: session.holdings_set( oclcNumbers=\"00000000123,00000000124,00000000125,00000000126\") session.holdings_unset(oclcNumbers=[123, 124, 125, 126]) The OCLC web service limits the number of records in a batch operation to 50, but MetadataSession permits larger batches by splitting the batch into chunks of 50 and automatically issuing multiple requests. The return object is a list of returned from server responses. results = session.holdings_unset(oclcNumbers=[123, 124, 125, 126]) # print results of each batch of 50s for r in results: print(r.json()) A consortium type of organizations that serve multiple libraries can utilize holdings_set_multi_institutions and holdings_unset_multi_institutions methods to set and unset holdings for selected libraries. List of library OCLC codes is passed as a comma separated string to instSymbol parameter. results = session.holdings_set_multi_institutions(oclcNumber=1234, instSymbols=\"BKL,NYP\") Examples Complex search query: from bookops_worldcat import WorldcatAccessToken, MetadataSession # obtain access token token = WorldcatAccessToken( key=\"my_WSKey\", secret=\"my_secret\", scopes=[\"WorldCatMetadataAPI\"], principal_id=\"my_principal_id\", principal_idns=\"my_principal_idns\", agent=\"my_app/version 1.0\" ) with MetadataSession(authorization=token) as session: # search Worlcat response = session.search_brief_bibs( q=\"su:civil war AND (su:antietam OR su:sharpsburg)\", datePublished=\"2000-2020\", inLanguage=\"eng\", inCatalogLanguage=\"eng\", catalogSource=\"dlc\", itemType=\"book\", itemSubType=\"digital\", orderBy=\"mostWidelyHeld\", limit=20) first_bib = response.json()[\"briefRecords\"][0] first_bib_number = first_bib[\"oclcNumber\"] # get full bib response = session.get_full_bib(oclcNumber=first_bib_number) print(response.content)","title":"Home"},{"location":"#bookops-worldcat","text":"","title":"BookOps-Worldcat"},{"location":"#overview","text":"Requires Python 3.7 and up. Bookops-Worldcat is a Python wrapper around OCLC's Worldcat Metadata API which supports changes released in the version 1.1 (May 2020) of the web service. The package features methods that utilize search functionality of the API as well as read-write endpoints . The Bookops-Worldcat package simplifies some of the OCLC API boilerplate, and ideally lowers the technological threshold for cataloging departments that may not have sufficient programming support to access and utilize those web services. Python language, with its gentle learning curve, has the potential to be a perfect vehicle towards this goal. This package takes advantage of the functionality of the popular Requests library . Interaction with OCLC's services is built around Requests sessions. MetadataSession inherits all requests.Session properties. Returned server responses are requests.Response objects with all of their properties and methods . Authorizing a session simply requires passing an access token into MetadataSession . Opening a session allows the user to call specific methods which facilitate communication between the user's script/client and a particular endpoint of OCLC's service. Many of the hurdles related to making valid requests are hidden under the hood of this package, making it as simple as possible to access the functionalities of OCLC APIs. Please note, not all features of the Metadata API are implemented because this tool was primarily built for our organization's specific needs. However, we are open to any collaboration to expand and improve the package. Supported OCLC web services: At the moment, the wrapper supports only OAuth 2.0 endpoints and flows . The specific protocols are Client Credential Grant and Access Token for authorization. Worldcat Metadata API is a read-write service for WorldCat. It allows adding and updating records in WorldCat, maintaining holdings, and working with local bibliographic data. Access to Metadata API requires OCLC credentials. The BookOps wrapper focuses on the following API operations: Search functionality Find member shared print holdings ( /bibs-retained-holdings ) Get summary of holdings for known items ( /bibs-summary-holdings ) Brief bibliographic resources: Search brief bibliographic resources ( /brief-bibs ) Retrieve specific brief bibliographic resource ( /brief-bibs/{oclcNumber} ) Retrieve other editions related to a particular bibliographic resource ( /brief-bibs/{oclcNumber}/other-editions ) Full bibliographic resources Retrieve full bibliographic record ( /bib-data ) Get current OCLC number ( /bib/checkcontrolnumber ) Holdings Set and unset institution holding ( /ih/data ) Retrieve status of institution holdings ( /ih/checkholdings ) Set and unset institution holdings for a batch or records ( /ih/datalist ) Set and unset holdings for a single record for multiple intitutions ( /ih/institutionlist )","title":"Overview"},{"location":"#installation","text":"To install use pip: $ pip -m install bookops-worldcat","title":"Installation"},{"location":"#quickstart","text":"Worldcat Metadata API requires OCLC credentials which can be obtained at the OCLC Developer Network site.","title":"Quickstart"},{"location":"#obtaining-access-token","text":"The Worldcat access token can be obtained by passing credential parameters into the WorldcatAccessToken object. >>> from bookops_worldcat import WorldcatAccessToken >>> token = WorldcatAccessToken( key=\"my_WSKey\", secret=\"my_secret\", scopes=[\"WorldCatMetadataAPI\"], principal_id=\"my_principal_id\", principlal_idns=\"my_principal_idns\" ) >>> print(token) \"access_token: 'tk_Yebz4BpEp9dAsghA7KpWx6dYD1OZKWBlHjqW', expires_at: '2020-01-01 17:19:58Z'\" >>> print(token.is_expired()) False Created token object can be directly passed into MetadataSession to authorize requests to the Metadata API web service: >>> from bookops_worldcat import MetadataSession >>> session = MetadataSession(authorization=token)","title":"Obtaining Access Token"},{"location":"#searching-brief-bibliographic-records-using-metadata-api","text":"The MetadataSession is authenticated using the WorldcatAccessToken object. The session allows searching brief records as well as retrieving full bibs in the MARC XML format. Basic usage: from bookops_worldcat import MetadataSession with MetadataSession(authorization=token) as session: results = session.search_brief_bibs(q=\"ti:zendegi AND au:greg egan\") print(results.json()) Returned brief bibliographic records are in the JSON format that can be parsed via .json() method. { \"numberOfRecords\": 24, \"briefRecords\": [ { \"oclcNumber\": \"430840771\", \"title\": \"Zendegi\", \"creator\": \"Greg Egan\", \"date\": \"2010\", \"language\": \"eng\", \"generalFormat\": \"Book\", \"specificFormat\": \"PrintBook\", \"edition\": \"First edition.\", \"publisher\": \"Night Shade Books\", \"mergedOclcNumbers\": [ \"664026825\" ], \"catalogingInfo\": { \"catalogingAgency\": \"BTCTA\", \"transcribingAgency\": \"DLC\" } }, { \"oclcNumber\": \"961162511\", \"title\": \"Zendegi\", \"creator\": \"Greg Egan\", \"date\": \"2013\", \"language\": \"eng\", \"generalFormat\": \"AudioBook\", \"specificFormat\": \"CD\", \"publisher\": \"Audible Studios on Brilliance Audio\", \"mergedOclcNumbers\": [ \"947806980\" ], \"catalogingInfo\": { \"catalogingAgency\": \"AU@\", \"transcribingAgency\": \"AU@\" } }, ] }","title":"Searching Brief Bibliographic Records Using Metadata API"},{"location":"#retrieving-full-bibliographic-records","text":"To retrieve a full bibliographic record from WorldCat use the .get_full_bib method. The server returns records in MARC XML format by default. from bookops_worldcat import MetadataSession with MetadataSession(authorization=token) as session: results = session.get_full_bib(oclcNumber=430840771) print(results.text) <?xml version=\"1.0\" encoding=\"UTF-8\"?> <entry xmlns=\"http://www.w3.org/2005/Atom\"> <content type=\"application/xml\"> <response xmlns=\"http://worldcat.org/rb\" mimeType=\"application/vnd.oclc.marc21+xml\"> <record xmlns=\"http://www.loc.gov/MARC21/slim\"> <leader>00000cam a2200000 i 4500</leader> <controlfield tag=\"001\">on1143317889</controlfield> <controlfield tag=\"003\">OCoLC</controlfield> <controlfield tag=\"005\">20200328101446.1</controlfield> <controlfield tag=\"008\">200305t20202019nyuabf b 001 0 eng c</controlfield> <datafield tag=\"010\" ind1=\" \" ind2=\" \"> <subfield code=\"a\"> 2018957420</subfield> </datafield> <datafield tag=\"040\" ind1=\" \" ind2=\" \"> <subfield code=\"a\">NYP</subfield> <subfield code=\"b\">eng</subfield> <subfield code=\"e\">rda</subfield> <subfield code=\"c\">NYP</subfield> <!--...--> <datafield tag=\"020\" ind1=\" \" ind2=\" \"> <subfield code=\"a\">9780316230049</subfield> <subfield code=\"q\">(pbk.)</subfield> <!--...--> <datafield tag=\"100\" ind1=\"1\" ind2=\" \"> <subfield code=\"a\">Christakis, Nicholas A.,</subfield> <subfield code=\"e\">author.</subfield> </datafield> <datafield tag=\"245\" ind1=\"1\" ind2=\"0\"> <subfield code=\"a\">Blueprint :</subfield> <subfield code=\"b\">the evolutionary origins of a good society /</subfield> <subfield code=\"c\">Nicholas A. Christakis.</subfield> </datafield> <datafield tag=\"250\" ind1=\" \" ind2=\" \"> <subfield code=\"a\">First Little, Brown Spark trade paperback edition.</subfield> </datafield> <datafield tag=\"264\" ind1=\" \" ind2=\"1\"> <subfield code=\"a\">New York, NY :</subfield> <subfield code=\"b\">Little, Brown Spark,</subfield> <subfield code=\"c\">2020</subfield> </datafield> <!--...--> </record> </response> </content> <id>http://worldcat.org/oclc/1143317889</id> <link href=\"http://worldcat.org/oclc/1143317889\"></link> </entry>","title":"Retrieving Full Bibliographic Records"},{"location":"#updating-holdings","text":"MetadataSession can be used to check or set/unset your library holdings on a master record in Worldcat: example: result = session.holding_set(oclc_number=\"850939579\") print(result) <Response [201]> result = session.holding_get_status(\"850939579\") print(result.json()) { \"title\": \"850939579\", \"content\": { \"requestedOclcNumber\": \"850939579\", \"currentOclcNumber\": \"850939579\", \"institution\": \"NYP\", \"holdingCurrentlySet\": true, \"id\": \"http://worldcat.org/oclc/850939579\" }, \"updated\": \"2020-10-01T04:10:13.017Z\" } For holdings operations on batches of records see Advanced Usage>MetadataSession>Updating Holdings","title":"Updating Holdings"},{"location":"#advanced-usage","text":"Identifying your application BookOps-Worldcat provides a default user-agent value in headers of all requests to OCLC web services: bookops-worldcat/{version} . It is encouraged to update the user-agent value to properly identify your application to OCLC servers. This will provide a useful piece of information for OCLC staff if they need to assist with troubleshooting problems that may arise. To set a custom \"user-agent\" in a session simply pass is as an argument when initiating the session: session = MetadataSession(authorization=token, agent=\"my_client_name\") ... or simply update its headers attribute: session.headers.update({\"user-agent\": \"my-app/version 1.0\"}) The user-agent header can be set for an access token request as well. To do that simply pass it as the agent parameter when initiating WorldcatAccessToken object: token = WorldcatAccessToken( key=\"my_WSKey\", secret=\"my_secret\", scopes=[\"WorldCatMetadataAPI\"], principal_id=\"my_principal_id\", principlal_idns=\"my_principal_idns\", agent=\"my_app/1.0.0\" ) Event hooks MetadataSession methods support Requests event hooks which can be passed as an argument: def print_url(response, *args, **kwargs): print(response.url) hooks = {'response': print_url} session.get_brief_bib(850939579, hooks=hooks)","title":"Advanced Usage"},{"location":"#worldcataccesstoken","text":"Bookops-Worldcat utilizes OAuth 2.0 and Client Credential Grant flow to acquire Access Token. Please note, your OCLC credentials must allow access to the Metadata API in their scope to be permitted to make requests to the web service. Obtaining: from bookops_worldcat import WorldcatAccessToken token = WorldcatAccessToken( key=\"my_WSKey\", secret=\"my_secret\", scopes=[\"WorldCatMetadataAPI\"], principal_id=\"my_principal_id\", principlal_idns=\"my_principal_idns\", agent=\"my_app/version 1.0\" ) Token object retains underlying Requests object functionality ( requests.Request ) that can be accessed via the .server_response attribute: print(token.server_response.status_code) 200 print(token.server_response.elapsed): 0:00:00.650108 print(token.server_response.json()) { \"user-agent\": \"bookops-worldcat/0.1.0\", \"Accept-Encoding\": \"gzip, deflate\", \"Accept\": \"application/json\", \"Connection\": \"keep-alive\", \"Content-Length\": \"67\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic encoded_authorization_here=\" } Checking if the token has expired can be done by calling the is_expired method: print(token.is_expired()) True A failed token request raises WorldcatAuthorizationError which provides a returned by the server error code and detailed message.","title":"WorldcatAccessToken"},{"location":"#metadatasession","text":"A wrapper around WorldCat Metadata API. MetadataSession inherits requests.Session methods. Returned full bibliographic records are by default in MARC/XML format, but it is possible to receive OCLC's native CDF XML and the CDF translation into JSON serializations by supplying appropriate values in the response_format argument to the get_full_bib method. Search endpoints of the Metadata API return responses serialized into JSON format only. All MetadataSession issued requests have a build-in access token auto-refresh feature. While a session is open, before any request is sent, a current token is checked for expiration and if needed a new access token is automatically obtained. OCLC numbers in methods' arguments MetadataSession accepts OCLC numbers in methods' arguments as integers or strings with or without a prefix (\"ocm\", \"ocn\", \"on\"). The following are all acceptable: session.get_brief_bib(oclcNumber=\"ocm00012345\") session.get_brief_bib(oclcNumber=\"00012345\") session.get_brief_bib(oclcNumber=12345) session.search_current_control_numbers(oclcNumbers=[\"ocm00012345\", \"00012346\", 12347])","title":"MetadataSession"},{"location":"#search-functionality","text":"MetadataSession supports the following search functionality: get_brief_bib retrieves a specific brief bibliographic resource search_brief_bib_other_editions retrieves other editions related to a bibliographic resource specified with an OCLC # search_brief_bibs retrieves brief resouces for a keyword or a fielded query search_current_control_numbers retrieves current OCLC control numbers search_general_holdings retrieves a summary of holdings for a specified item search_shared_print_holdings finds member library holdings with a commitment to retain (Shared Print) The server responses are returned in JSON format by default. Obtaining brief record with MetadataSession(authorization=token) as session: result = session.get_brief_bib(850940548) print(results.json()) { \"oclcNumber\": \"850940548\", \"title\": \"Record Builder Added This Test Record On 06/26/2013 13:07:06.\", \"creator\": \"OCLC RecordBuilder.\", \"date\": \"2012\", \"language\": \"eng\", \"generalFormat\": \"Book\", \"specificFormat\": \"PrintBook\", \"catalogingInfo\": { \"catalogingAgency\": \"OCPSB\", \"transcribingAgency\": \"OCPSB\" } } Quering WorldCat Metadata API provides quite robust methods to query WorldCat. In addition to a flexible query string that supports keyword and fielded searches, it is possibile to set further limits using various elements such as type of item, language, publishing date, etc. It is possible to specify the order of returned records by using the orderBy argument. Results are returned as brief records in JSON format. The query syntax is case-insensitive and allows keyword and phrase search (use quotation marks), boolean operators (AND, OR, NOT), wildcards (# - single character, ? - any number of additional characters), and truncation (use * character). keyword search with item type, language, and publishing date limiters: session.search_brief_bibs( q=\"czarne oceany dukaj\", itemType=\"book\", inLanguage=\"pol\", datePublished=\"2015-2020\" orderBy=\"publicationDateDesc\" ) fielded query: session.search_brief_bibs( q='ti=\"czarne oceany\" AND au:jacek dukaj AND ge=\"science fiction\"') More about the query syntax can be found in OCLC documentation","title":"Search Functionality"},{"location":"#obtaining-full-bibliographic-records","text":"session.get_full_bib() method with OCLC number as an argument sends a request for a matching full bibliographic record in WorldCat. The Metadata API correctly matches requested OCLC numbers of records that have been merged together by returning the current master record. By default get_full_bib returns records in MARC XML format. Returned response is a requests.Response object with all its features: with MetadataSession(authorization=token) as session: result = session.get_full_bib(\"00000000123\") print(result.status_code) print(result.url) 200 \"https://worldcat.org/bib/data/00000000123\" To avoid any UnicodeEncodeError it is recommended to access retrieved data with .content attribute of the response object: print(response.content)","title":"Obtaining Full Bibliographic Records"},{"location":"#retrieving-current-oclc-number","text":"MetadataSession.search_current_control_numbers method allows retrieval of a current control number of the master record in WorldCat. Occasionally, records identified as duplicates in WorldCat have been merged. In that case a local control number may not correctly refer to an OCLC master record. Returned responses are in JSON format by default, but it's possible to pass 'application/atom+xml' in the response_format argument to have the response serialized into xml. search_current_control_numbers method accepts control numbers as a list or a comma separated string: session.search_current_control_numbers(oclcNumbers=\"00012345,00012346,00012347\") session.search_current_control_numbers(oclcNumbers=[12345, 12346, 12347], response_format=\"application/atom+xml\")","title":"Retrieving Current OCLC Number"},{"location":"#holdings","text":"MetadataSession supports the following holdings operations: holding_get_status retrieves holding status of a requested record holding_set sets holding on an individual bibliographic record holding_unset deletes holding on an individual bibliographic record holdings_set allows holdings to be set on multiple records, and is not limited by OCLC's 50 bib record limit holdings_unset allows holdings to be deleted on multiple records, and is not limited to OCLC's 50 bib record restriction holdings_set_multi_institutions allows to set holdings for a single record for multiple institutions holdings_unset_multi_institutions deletes holdings on a single record for multiple institutions By default, responses are returned in atom+json format, but atom+xml can be specified: result = session.holding_get_status(oclcNumber=\"ocn123456789\", response_format=\"application/atom+xml\") print(result.text) <?xml version=\"1.0\" encoding=\"UTF-8\"?> <entry xmlns=\"http://www.w3.org/2005/Atom\"> <title type=\"text\">1143317889</title> <updated>2020-04-25T05:21:10.233Z</updated> <content type=\"application/xml\"> <holdings xmlns=\"http://worldcat.org/metadata-api-service\"> <requestedOclcNumber>1143317889</requestedOclcNumber> <currentOclcNumber>1143317889</currentOclcNumber> <institution>NYP</institution> <holdingCurrentlySet>true</holdingCurrentlySet> <id>http://worldcat.org/oclc/1143317889</id> </holdings> </content> </entry> Pass OCLC record numbers for batch operations as a list of strings or integers or comma separated string with or without a prefix: session.holdings_set( oclcNumbers=\"00000000123,00000000124,00000000125,00000000126\") session.holdings_unset(oclcNumbers=[123, 124, 125, 126]) The OCLC web service limits the number of records in a batch operation to 50, but MetadataSession permits larger batches by splitting the batch into chunks of 50 and automatically issuing multiple requests. The return object is a list of returned from server responses. results = session.holdings_unset(oclcNumbers=[123, 124, 125, 126]) # print results of each batch of 50s for r in results: print(r.json()) A consortium type of organizations that serve multiple libraries can utilize holdings_set_multi_institutions and holdings_unset_multi_institutions methods to set and unset holdings for selected libraries. List of library OCLC codes is passed as a comma separated string to instSymbol parameter. results = session.holdings_set_multi_institutions(oclcNumber=1234, instSymbols=\"BKL,NYP\")","title":"Holdings"},{"location":"#examples","text":"Complex search query: from bookops_worldcat import WorldcatAccessToken, MetadataSession # obtain access token token = WorldcatAccessToken( key=\"my_WSKey\", secret=\"my_secret\", scopes=[\"WorldCatMetadataAPI\"], principal_id=\"my_principal_id\", principal_idns=\"my_principal_idns\", agent=\"my_app/version 1.0\" ) with MetadataSession(authorization=token) as session: # search Worlcat response = session.search_brief_bibs( q=\"su:civil war AND (su:antietam OR su:sharpsburg)\", datePublished=\"2000-2020\", inLanguage=\"eng\", inCatalogLanguage=\"eng\", catalogSource=\"dlc\", itemType=\"book\", itemSubType=\"digital\", orderBy=\"mostWidelyHeld\", limit=20) first_bib = response.json()[\"briefRecords\"][0] first_bib_number = first_bib[\"oclcNumber\"] # get full bib response = session.get_full_bib(oclcNumber=first_bib_number) print(response.content)","title":"Examples"},{"location":"about/","text":"BookOps BookOps is a fully consolidated, shared library technical services organization that serves the Brooklyn Public Library (BPL) and the New York Public Library (NYPL). BookOps-Worldcat was glued together by Tomasz Kalata with contribution by Miriam Gloger .","title":"About"},{"location":"about/#bookops","text":"BookOps is a fully consolidated, shared library technical services organization that serves the Brooklyn Public Library (BPL) and the New York Public Library (NYPL). BookOps-Worldcat was glued together by Tomasz Kalata with contribution by Miriam Gloger .","title":"BookOps"},{"location":"changelog/","text":"Changelog [0.5.0] - (3/11/2022) Added feature to set and unset holdings for individual record for multiple institutions (/ih/institutionlist endpoint) __repr__ method to WorldcatAccessToken object Changed \"refreshing\" of access tokens moved to _session.WorldcatSession from metadata_api.MetadataSession to allow inheritance of this functionality by future clients refactors some of tests 0.4.1 - (2/10/2022) Fixed Handling of unexpected 206 HTTP code that is occasionally returned by the MetadataAPI /brief-bibs endpoint Changed Introduced a breaking change to exceptions raised on calls to the web service for bibliographic resources: WorldcatSessionError was changed to WorldcatRequestError . Dev dependencies updates (pytest, pytest-cov, pytest-mock, mkdocs, black, mik, mkapi, mypy) Changed requests to OCLC services are now handled by a new query.Query class dependencies update requests to 2.27.1 dev dependencies 0.4.0 - (6/22/2021) Changed Changes to MetadataSession.search_brief_bibs method due to /brief-bibs endpoint changes: removed deprecated argument heldBy added groupVariantRecord and preferredLanuage argument modified groupRelatedEditions to allow boolean arguments Changes to MetadataSession.search_general_holdings method due to API changes: added following arguements: holdingsAllVariantRecords , preferredLanguage removed deprecated heldBy argument Changes to MetadataSession.search_brief_bib_other_editions : added deweyNumber , datePublished , heldByGroup , heldBySymbol , heldByInstitutionId , inLanguage , inCatalogLanguage , materialType , catalogSource , itemType , itemSubType , retentionCommitments , spProgram , topic , subtopic , audience , content , openAccess , peerReviewed , facets , groupVariantRecords , preferredLanguage , and orderBy . 0.3.5 - (6/2/2021) Changed Dependencies update urllib3 from 1.26.4 to 1.26.5 0.3.4 - (3/22/2021) Changed Dependencies update certifi to 2020.12.5 chardet to 4.0.0 requests to 2.25.1 urllib3 to 1.26.4 0.3.3 - (12/28/2020) Added Type hints Default timeout in the MetadataSesssion extended to 5 seconds Changed Dependencies: pytest bump to 6.1.2 mypy 0.7.8 0.3.2 - (11/25/2020) Fixed MetadataSession timeout paramerter correctly passed into every session request 0.3.1 - (11/24/2020) Fixed Fixed auto refreshing of the access token when expired testing: fixed testing for error messages on exceptions & testing of stale tokens Changed Dependencies bump certifi from 2020.6.20 to 2020.11.8 requests from 2.24.0 to 2.25.0 urlib3 from 1.25.10 to 1.26.2 Added Added Python 3.9 testing to CI 0.3.0 - (10/03/2020) Changed Introduces multiple breaking changes compared to the previous version! Dropped features related to the WorldCat Search API Support for Worldcat Metadata API v.1.1 introduced in May 2020 Supported Metdata API endpoints: /bibs-retained-holdings /bibs-summary-holdings /brief-bibs /brief-bibs/{oclcNumber} /brief-bibs/{oclcNumber}/other-editions /bib/data/{oclcNumber} /bib/checkcontrolnumbers /ih/data (POST|DELETE) /ih/checkholdings /ih/datalist (POST|DELETE) Added API reference added to docs with mkapi 0.2.1 - (9/28/2020) Added added functionality for docs versioning with mike 0.2.0 - (04/30/2020) Added Expanded and improved documentation Customizable \"user-agent\" in session header and token request TokenRequestError exception added on failed access token request Changed SRU/CQL query syntax aligned with OCLC specifications Fixed fixed hooks info in docstrings in SearchSession and MetadataSession","title":"Changelog"},{"location":"changelog/#changelog","text":"","title":"Changelog"},{"location":"changelog/#050-3112022","text":"","title":"[0.5.0] - (3/11/2022)"},{"location":"changelog/#added","text":"feature to set and unset holdings for individual record for multiple institutions (/ih/institutionlist endpoint) __repr__ method to WorldcatAccessToken object","title":"Added"},{"location":"changelog/#changed","text":"\"refreshing\" of access tokens moved to _session.WorldcatSession from metadata_api.MetadataSession to allow inheritance of this functionality by future clients refactors some of tests","title":"Changed"},{"location":"changelog/#041-2102022","text":"","title":"0.4.1 - (2/10/2022)"},{"location":"changelog/#fixed","text":"Handling of unexpected 206 HTTP code that is occasionally returned by the MetadataAPI /brief-bibs endpoint","title":"Fixed"},{"location":"changelog/#changed_1","text":"Introduced a breaking change to exceptions raised on calls to the web service for bibliographic resources: WorldcatSessionError was changed to WorldcatRequestError . Dev dependencies updates (pytest, pytest-cov, pytest-mock, mkdocs, black, mik, mkapi, mypy)","title":"Changed"},{"location":"changelog/#changed_2","text":"requests to OCLC services are now handled by a new query.Query class dependencies update requests to 2.27.1 dev dependencies","title":"Changed"},{"location":"changelog/#040-6222021","text":"","title":"0.4.0 - (6/22/2021)"},{"location":"changelog/#changed_3","text":"Changes to MetadataSession.search_brief_bibs method due to /brief-bibs endpoint changes: removed deprecated argument heldBy added groupVariantRecord and preferredLanuage argument modified groupRelatedEditions to allow boolean arguments Changes to MetadataSession.search_general_holdings method due to API changes: added following arguements: holdingsAllVariantRecords , preferredLanguage removed deprecated heldBy argument Changes to MetadataSession.search_brief_bib_other_editions : added deweyNumber , datePublished , heldByGroup , heldBySymbol , heldByInstitutionId , inLanguage , inCatalogLanguage , materialType , catalogSource , itemType , itemSubType , retentionCommitments , spProgram , topic , subtopic , audience , content , openAccess , peerReviewed , facets , groupVariantRecords , preferredLanguage , and orderBy .","title":"Changed"},{"location":"changelog/#035-622021","text":"","title":"0.3.5 - (6/2/2021)"},{"location":"changelog/#changed_4","text":"Dependencies update urllib3 from 1.26.4 to 1.26.5","title":"Changed"},{"location":"changelog/#034-3222021","text":"","title":"0.3.4 - (3/22/2021)"},{"location":"changelog/#changed_5","text":"Dependencies update certifi to 2020.12.5 chardet to 4.0.0 requests to 2.25.1 urllib3 to 1.26.4","title":"Changed"},{"location":"changelog/#033-12282020","text":"","title":"0.3.3 - (12/28/2020)"},{"location":"changelog/#added_1","text":"Type hints Default timeout in the MetadataSesssion extended to 5 seconds","title":"Added"},{"location":"changelog/#changed_6","text":"Dependencies: pytest bump to 6.1.2 mypy 0.7.8","title":"Changed"},{"location":"changelog/#032-11252020","text":"","title":"0.3.2 - (11/25/2020)"},{"location":"changelog/#fixed_1","text":"MetadataSession timeout paramerter correctly passed into every session request","title":"Fixed"},{"location":"changelog/#031-11242020","text":"","title":"0.3.1 - (11/24/2020)"},{"location":"changelog/#fixed_2","text":"Fixed auto refreshing of the access token when expired testing: fixed testing for error messages on exceptions & testing of stale tokens","title":"Fixed"},{"location":"changelog/#changed_7","text":"Dependencies bump certifi from 2020.6.20 to 2020.11.8 requests from 2.24.0 to 2.25.0 urlib3 from 1.25.10 to 1.26.2","title":"Changed"},{"location":"changelog/#added_2","text":"Added Python 3.9 testing to CI","title":"Added"},{"location":"changelog/#030-10032020","text":"","title":"0.3.0 - (10/03/2020)"},{"location":"changelog/#changed_8","text":"Introduces multiple breaking changes compared to the previous version! Dropped features related to the WorldCat Search API Support for Worldcat Metadata API v.1.1 introduced in May 2020 Supported Metdata API endpoints: /bibs-retained-holdings /bibs-summary-holdings /brief-bibs /brief-bibs/{oclcNumber} /brief-bibs/{oclcNumber}/other-editions /bib/data/{oclcNumber} /bib/checkcontrolnumbers /ih/data (POST|DELETE) /ih/checkholdings /ih/datalist (POST|DELETE)","title":"Changed"},{"location":"changelog/#added_3","text":"API reference added to docs with mkapi","title":"Added"},{"location":"changelog/#021-9282020","text":"","title":"0.2.1 - (9/28/2020)"},{"location":"changelog/#added_4","text":"added functionality for docs versioning with mike","title":"Added"},{"location":"changelog/#020-04302020","text":"","title":"0.2.0 - (04/30/2020)"},{"location":"changelog/#added_5","text":"Expanded and improved documentation Customizable \"user-agent\" in session header and token request TokenRequestError exception added on failed access token request","title":"Added"},{"location":"changelog/#changed_9","text":"SRU/CQL query syntax aligned with OCLC specifications","title":"Changed"},{"location":"changelog/#fixed_3","text":"fixed hooks info in docstrings in SearchSession and MetadataSession","title":"Fixed"},{"location":"tutorials/","text":"Tutorials Save a full bib XML response to a file in MARC21 format This recipe shows how to query Worldcat for specific full bibliographic records and save the results to a file in MARC21 format. A conversion from the response to the MARC format is handled by the pymarc library (see more at https://pypi.org/project/pymarc/ ), specifically its parse_xml_to_array and as_marc methods. The code below requires an access token ( WorldcatAccessToken object ) to be passed to the MetadataSession for authorization. from io import BytesIO from bookops_worldcat import MetadataSession from pymarc import parse_xml_to_array oclc_numbers = [850939580, 850939581, 850939582] # obtain first an access token using the WorldcatAccessToken and # your OCLC Metadata API credentials with MetadataSession(authorization=token) as session: for o in oclc_numbers: response = session.get_full_bib(oclcNumber=o) data = BytesIO(response.content) # convert into pymarc Record object bib = parse_xml_to_array(data)[0] # manipulate bib to your liking before saving to a file # append to a MARC21 file: with open(\"retrieved_bibs.mrc\", \"ab\") as out: out.write(bib.as_marc())","title":"Tutorials"},{"location":"tutorials/#tutorials","text":"","title":"Tutorials"},{"location":"tutorials/#save-a-full-bib-xml-response-to-a-file-in-marc21-format","text":"This recipe shows how to query Worldcat for specific full bibliographic records and save the results to a file in MARC21 format. A conversion from the response to the MARC format is handled by the pymarc library (see more at https://pypi.org/project/pymarc/ ), specifically its parse_xml_to_array and as_marc methods. The code below requires an access token ( WorldcatAccessToken object ) to be passed to the MetadataSession for authorization. from io import BytesIO from bookops_worldcat import MetadataSession from pymarc import parse_xml_to_array oclc_numbers = [850939580, 850939581, 850939582] # obtain first an access token using the WorldcatAccessToken and # your OCLC Metadata API credentials with MetadataSession(authorization=token) as session: for o in oclc_numbers: response = session.get_full_bib(oclcNumber=o) data = BytesIO(response.content) # convert into pymarc Record object bib = parse_xml_to_array(data)[0] # manipulate bib to your liking before saving to a file # append to a MARC21 file: with open(\"retrieved_bibs.mrc\", \"ab\") as out: out.write(bib.as_marc())","title":"Save a full bib XML response to a file in MARC21 format"},{"location":"api/bookops_worldcat.authorize/","text":"module bookops_worldcat . authorize </> This module provides means to authenticate and obtain a WorldCat access token. Classes WorldcatAccessToken \u2014 Requests Worldcat access token. Authenticates and authorizes using Client Credentials Grant. Does not support Explicit Authorization Code and Refresh Token flows. Token with correctly bonded scopes can then be passed into a session of particular web service to authorize requests for resources. More on OCLC's web services authorization: https://www.oclc.org/developer/develop/authentication/oauth/client-credentials-grant.en.html </> class bookops_worldcat.authorize . WorldcatAccessToken ( key , secret , scopes , principal_id , principal_idns , agent=None , timeout=None ) </> Requests Worldcat access token. Authenticates and authorizes using Client Credentials Grant. Does not support Explicit Authorization Code and Refresh Token flows. Token with correctly bonded scopes can then be passed into a session of particular web service to authorize requests for resources. More on OCLC's web services authorization: https://www.oclc.org/developer/develop/authentication/oauth/client-credentials-grant.en.html Parameters key (str) \u2014 your WSKey public client_id secret (str) \u2014 your WSKey secret scopes (Union) \u2014 request scopes for the access token principal_id (str) \u2014 principalID (required for read/write endpoints) principal_idns (str) \u2014 principalIDNS (required for read/write endpoints) agent (Optional, optional) \u2014 \"User-agent\" parameter to be passed in the request header; usage strongly encouraged timeout (Union, optional) \u2014 how long to wait for server to send data before giving up; default value is 3 seconds Examples >>> from bookops_worldcat import WorldcatAccessToken >>> token = WorldcatAccessToken( key=\"my_WSKey_client_id\", secret=\"my_WSKey_secret\", scope=\"WorldCatMetadataAPI\", principal_id=\"your principalID here\", principal_idns=\"your principalIDNS here\", agent=\"my_app/1.0.0\") >>> token.token_str \"tk_Yebz4BpEp9dAsghA7KpWx6dYD1OZKWBlHjqW\" >>> token.is_expired() False >>> token.server_response.json() {\"token_token\": \"tk_Yebz4BpEp9dAsghA7KpWx6dYD1OZKWBlHjqW\", \"token_type\": \"bearer\", \"expires_in\": \"1199\", \"principalID\": \"\", \"principalIDNS\": \"\", \"scopes\": \"WorldCatMetadataAPI\", \"contextInstitutionId\": \"00001\", \"expires_at\": \"2020-08-23 18:45:29Z\"} >>> token.server_response.request.headers {\"User-Agent\": \"my_app/1.0.0\", \"Accept-Encoding\": \"gzip, deflate\", \"Accept\": \"application/json\", \"Connection\": \"keep-alive\", \"Content-Length\": \"67\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic encoded_authorization_here=\"} Methods is_expired ( ) (bool) \u2014 Checks if the access token is expired. </> method is_expired ( ) </> Checks if the access token is expired. Returns (bool) bool Example >>> token.is_expired() False","title":"bookops_worldcat.authorize"},{"location":"api/bookops_worldcat.authorize/#bookops_worldcatauthorize","text":"</> This module provides means to authenticate and obtain a WorldCat access token. Classes WorldcatAccessToken \u2014 Requests Worldcat access token. Authenticates and authorizes using Client Credentials Grant. Does not support Explicit Authorization Code and Refresh Token flows. Token with correctly bonded scopes can then be passed into a session of particular web service to authorize requests for resources. More on OCLC's web services authorization: https://www.oclc.org/developer/develop/authentication/oauth/client-credentials-grant.en.html </> class","title":"bookops_worldcat.authorize"},{"location":"api/bookops_worldcat.authorize/#bookops_worldcatauthorizeworldcataccesstoken","text":"</> Requests Worldcat access token. Authenticates and authorizes using Client Credentials Grant. Does not support Explicit Authorization Code and Refresh Token flows. Token with correctly bonded scopes can then be passed into a session of particular web service to authorize requests for resources. More on OCLC's web services authorization: https://www.oclc.org/developer/develop/authentication/oauth/client-credentials-grant.en.html Parameters key (str) \u2014 your WSKey public client_id secret (str) \u2014 your WSKey secret scopes (Union) \u2014 request scopes for the access token principal_id (str) \u2014 principalID (required for read/write endpoints) principal_idns (str) \u2014 principalIDNS (required for read/write endpoints) agent (Optional, optional) \u2014 \"User-agent\" parameter to be passed in the request header; usage strongly encouraged timeout (Union, optional) \u2014 how long to wait for server to send data before giving up; default value is 3 seconds Examples >>> from bookops_worldcat import WorldcatAccessToken >>> token = WorldcatAccessToken( key=\"my_WSKey_client_id\", secret=\"my_WSKey_secret\", scope=\"WorldCatMetadataAPI\", principal_id=\"your principalID here\", principal_idns=\"your principalIDNS here\", agent=\"my_app/1.0.0\") >>> token.token_str \"tk_Yebz4BpEp9dAsghA7KpWx6dYD1OZKWBlHjqW\" >>> token.is_expired() False >>> token.server_response.json() {\"token_token\": \"tk_Yebz4BpEp9dAsghA7KpWx6dYD1OZKWBlHjqW\", \"token_type\": \"bearer\", \"expires_in\": \"1199\", \"principalID\": \"\", \"principalIDNS\": \"\", \"scopes\": \"WorldCatMetadataAPI\", \"contextInstitutionId\": \"00001\", \"expires_at\": \"2020-08-23 18:45:29Z\"} >>> token.server_response.request.headers {\"User-Agent\": \"my_app/1.0.0\", \"Accept-Encoding\": \"gzip, deflate\", \"Accept\": \"application/json\", \"Connection\": \"keep-alive\", \"Content-Length\": \"67\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic encoded_authorization_here=\"} Methods is_expired ( ) (bool) \u2014 Checks if the access token is expired. </> method","title":"bookops_worldcat.authorize.WorldcatAccessToken"},{"location":"api/bookops_worldcat.authorize/#bookops_worldcatauthorizeworldcataccesstokenis_expired","text":"</> Checks if the access token is expired. Returns (bool) bool Example >>> token.is_expired() False","title":"bookops_worldcat.authorize.WorldcatAccessToken.is_expired"},{"location":"api/bookops_worldcat.errors/","text":"module bookops_worldcat . errors </> This module contains the set of bookops_worldcat exceptions. Classes BookopsWorldcatError \u2014 Base class for exceptions in this module. </> WorldcatAuthorizationError \u2014 Exception raised when WorldCat access token is not obtained </> WorldcatSessionError \u2014 Exception raised during WorlCat session </> WorldcatRequestError \u2014 Exceptions raised on HTTP errors returned by web service </> InvalidOclcNumber \u2014 Exception raised when an invalid OCLC record number is encountered </> class bookops_worldcat.errors . BookopsWorldcatError ( ) </> Bases Exception BaseException Base class for exceptions in this module. class bookops_worldcat.errors . WorldcatAuthorizationError ( ) </> Bases bookops_worldcat.errors.BookopsWorldcatError Exception BaseException Exception raised when WorldCat access token is not obtained class bookops_worldcat.errors . WorldcatSessionError ( ) </> Bases bookops_worldcat.errors.BookopsWorldcatError Exception BaseException Exception raised during WorlCat session class bookops_worldcat.errors . WorldcatRequestError ( ) </> Bases bookops_worldcat.errors.WorldcatSessionError bookops_worldcat.errors.BookopsWorldcatError Exception BaseException Exceptions raised on HTTP errors returned by web service class bookops_worldcat.errors . InvalidOclcNumber ( ) </> Bases bookops_worldcat.errors.BookopsWorldcatError Exception BaseException Exception raised when an invalid OCLC record number is encountered","title":"bookops_worldcat.errors"},{"location":"api/bookops_worldcat.errors/#bookops_worldcaterrors","text":"</> This module contains the set of bookops_worldcat exceptions. Classes BookopsWorldcatError \u2014 Base class for exceptions in this module. </> WorldcatAuthorizationError \u2014 Exception raised when WorldCat access token is not obtained </> WorldcatSessionError \u2014 Exception raised during WorlCat session </> WorldcatRequestError \u2014 Exceptions raised on HTTP errors returned by web service </> InvalidOclcNumber \u2014 Exception raised when an invalid OCLC record number is encountered </> class","title":"bookops_worldcat.errors"},{"location":"api/bookops_worldcat.errors/#bookops_worldcaterrorsbookopsworldcaterror","text":"</> Bases Exception BaseException Base class for exceptions in this module. class","title":"bookops_worldcat.errors.BookopsWorldcatError"},{"location":"api/bookops_worldcat.errors/#bookops_worldcaterrorsworldcatauthorizationerror","text":"</> Bases bookops_worldcat.errors.BookopsWorldcatError Exception BaseException Exception raised when WorldCat access token is not obtained class","title":"bookops_worldcat.errors.WorldcatAuthorizationError"},{"location":"api/bookops_worldcat.errors/#bookops_worldcaterrorsworldcatsessionerror","text":"</> Bases bookops_worldcat.errors.BookopsWorldcatError Exception BaseException Exception raised during WorlCat session class","title":"bookops_worldcat.errors.WorldcatSessionError"},{"location":"api/bookops_worldcat.errors/#bookops_worldcaterrorsworldcatrequesterror","text":"</> Bases bookops_worldcat.errors.WorldcatSessionError bookops_worldcat.errors.BookopsWorldcatError Exception BaseException Exceptions raised on HTTP errors returned by web service class","title":"bookops_worldcat.errors.WorldcatRequestError"},{"location":"api/bookops_worldcat.errors/#bookops_worldcaterrorsinvalidoclcnumber","text":"</> Bases bookops_worldcat.errors.BookopsWorldcatError Exception BaseException Exception raised when an invalid OCLC record number is encountered","title":"bookops_worldcat.errors.InvalidOclcNumber"},{"location":"api/bookops_worldcat/","text":"package bookops_worldcat </> module bookops_worldcat . query </> Handles actual requests to OCLC services Classes Query \u2014 Sends a request to OClC service and unifies received exceptions Query object handles refreshing expired token before request is made to the web service. </> module bookops_worldcat . metadata_api </> This module provides MetadataSession class for requests to WorldCat Metadata API. Classes MetadataSession \u2014 OCLC Metadata API wrapper session. Inherits requests.Session methods </> module bookops_worldcat . authorize </> This module provides means to authenticate and obtain a WorldCat access token. Classes WorldcatAccessToken \u2014 Requests Worldcat access token. Authenticates and authorizes using Client Credentials Grant. Does not support Explicit Authorization Code and Refresh Token flows. Token with correctly bonded scopes can then be passed into a session of particular web service to authorize requests for resources. More on OCLC's web services authorization: https://www.oclc.org/developer/develop/authentication/oauth/client-credentials-grant.en.html </> module bookops_worldcat . utils </> Shared utilities module. Functions prep_oclc_number_str ( oclcNumber ) (str) \u2014 Checks for OCLC prefixes and removes them. </> verify_oclc_number ( oclcNumber ) (str) \u2014 Verifies a valid looking OCLC number is passed and normalize it as integer. </> verify_oclc_numbers ( oclcNumbers ) (vetted_numbers) \u2014 Parses and verifies list of oclcNumbers </> module bookops_worldcat . errors </> This module contains the set of bookops_worldcat exceptions. Classes BookopsWorldcatError \u2014 Base class for exceptions in this module. </> WorldcatAuthorizationError \u2014 Exception raised when WorldCat access token is not obtained </> WorldcatSessionError \u2014 Exception raised during WorlCat session </> WorldcatRequestError \u2014 Exceptions raised on HTTP errors returned by web service </> InvalidOclcNumber \u2014 Exception raised when an invalid OCLC record number is encountered </>","title":"bookops_worldcat"},{"location":"api/bookops_worldcat/#bookops_worldcat","text":"</> module","title":"bookops_worldcat"},{"location":"api/bookops_worldcat/#bookops_worldcatquery","text":"</> Handles actual requests to OCLC services Classes Query \u2014 Sends a request to OClC service and unifies received exceptions Query object handles refreshing expired token before request is made to the web service. </> module","title":"bookops_worldcat.query"},{"location":"api/bookops_worldcat/#bookops_worldcatmetadata_api","text":"</> This module provides MetadataSession class for requests to WorldCat Metadata API. Classes MetadataSession \u2014 OCLC Metadata API wrapper session. Inherits requests.Session methods </> module","title":"bookops_worldcat.metadata_api"},{"location":"api/bookops_worldcat/#bookops_worldcatauthorize","text":"</> This module provides means to authenticate and obtain a WorldCat access token. Classes WorldcatAccessToken \u2014 Requests Worldcat access token. Authenticates and authorizes using Client Credentials Grant. Does not support Explicit Authorization Code and Refresh Token flows. Token with correctly bonded scopes can then be passed into a session of particular web service to authorize requests for resources. More on OCLC's web services authorization: https://www.oclc.org/developer/develop/authentication/oauth/client-credentials-grant.en.html </> module","title":"bookops_worldcat.authorize"},{"location":"api/bookops_worldcat/#bookops_worldcatutils","text":"</> Shared utilities module. Functions prep_oclc_number_str ( oclcNumber ) (str) \u2014 Checks for OCLC prefixes and removes them. </> verify_oclc_number ( oclcNumber ) (str) \u2014 Verifies a valid looking OCLC number is passed and normalize it as integer. </> verify_oclc_numbers ( oclcNumbers ) (vetted_numbers) \u2014 Parses and verifies list of oclcNumbers </> module","title":"bookops_worldcat.utils"},{"location":"api/bookops_worldcat/#bookops_worldcaterrors","text":"</> This module contains the set of bookops_worldcat exceptions. Classes BookopsWorldcatError \u2014 Base class for exceptions in this module. </> WorldcatAuthorizationError \u2014 Exception raised when WorldCat access token is not obtained </> WorldcatSessionError \u2014 Exception raised during WorlCat session </> WorldcatRequestError \u2014 Exceptions raised on HTTP errors returned by web service </> InvalidOclcNumber \u2014 Exception raised when an invalid OCLC record number is encountered </>","title":"bookops_worldcat.errors"},{"location":"api/bookops_worldcat.metadata_api/","text":"module bookops_worldcat . metadata_api </> This module provides MetadataSession class for requests to WorldCat Metadata API. Classes MetadataSession \u2014 OCLC Metadata API wrapper session. Inherits requests.Session methods </> class bookops_worldcat.metadata_api . MetadataSession ( authorization , agent=None , timeout=None ) </> Bases bookops_worldcat._session.WorldcatSession requests.sessions.Session requests.sessions.SessionRedirectMixin OCLC Metadata API wrapper session. Inherits requests.Session methods Attributes auth \u2014 class: Request <Request> . cert \u2014 cert file (.pem). If Tuple, ('cert', 'key') pair. cookies \u2014 may be any other cookielib.CookieJar compatible object. headers \u2014 class: Session <Session> . hooks \u2014 Event-handling hooks. max_redirects \u2014 30. params \u2014 representing multivalued query parameters. proxies (be used on each) \u2014 class: Request <Request> . stream \u2014 Stream response content default. trust_env \u2014 authentication and similar. verify \u2014 Only set this to False for testing. Methods close ( ) \u2014 Closes all adapters and as such the session </> delete ( url , **kwargs ) \u2014 Sends a DELETE request. Returns :class: Response object. </> get ( url , **kwargs ) \u2014 Sends a GET request. Returns :class: Response object. </> get_adapter ( url ) \u2014 Returns the appropriate connection adapter for the given URL. </> get_brief_bib ( oclcNumber , hooks ) (Response) \u2014 Retrieve specific brief bibliographic resource. Uses /brief-bibs/{oclcNumber} endpoint. </> get_full_bib ( oclcNumber , response_format , hooks ) (Response) \u2014 Send a GET request for a full bibliographic resource. Uses /bib/data/{oclcNumber} endpoint. </> get_redirect_target ( resp ) \u2014 Receives a Response. Returns a redirect URI or None </> head ( url , **kwargs ) \u2014 Sends a HEAD request. Returns :class: Response object. </> holding_get_status ( oclcNumber , inst , instSymbol , response_format , hooks ) (Response) \u2014 Retrieves Worlcat holdings status of a record with provided OCLC number. The service automatically recognizes institution based on the issued access token. Uses /ih/checkholdings endpoint. </> holding_set ( oclcNumber , inst , instSymbol , holdingLibraryCode , classificationScheme , response_format , hooks ) (Response) \u2014 Sets institution's Worldcat holding on an individual record. Uses /ih/data endpoint. </> holding_unset ( oclcNumber , cascade , inst , instSymbol , holdingLibraryCode , classificationScheme , response_format , hooks ) (Response) \u2014 Deletes institution's Worldcat holding on an individual record. Uses /ih/data endpoint. </> holdings_set ( oclcNumbers , inst , instSymbol , response_format , hooks ) (List) \u2014 Set institution holdings for multiple OCLC numbers Uses /ih/datalist endpoint. </> holdings_set_multi_institutions ( oclcNumber , instSymbols , response_format , hooks ) (Response) \u2014 Batch sets intitution holdings for multiple intitutions </> holdings_unset ( oclcNumbers , cascade , inst , instSymbol , response_format , hooks ) (List) \u2014 Set institution holdings for multiple OCLC numbers Uses /ih/datalist endpoint. </> holdings_unset_multi_institutions ( oclcNumber , instSymbols , cascade , response_format , hooks ) (Response) \u2014 Batch unsets intitution holdings for multiple intitutions </> merge_environment_settings ( url , proxies , stream , verify , cert ) \u2014 Check the environment and merge it with some settings. </> mount ( prefix , adapter ) \u2014 Registers a connection adapter to a prefix. </> options ( url , **kwargs ) \u2014 Sends a OPTIONS request. Returns :class: Response object. </> patch ( url , data , **kwargs ) \u2014 Sends a PATCH request. Returns :class: Response object. </> post ( url , data , json , **kwargs ) \u2014 Sends a POST request. Returns :class: Response object. </> prepare_request ( request ) \u2014 Constructs a :class: PreparedRequest <PreparedRequest> for transmission and returns it. The :class: PreparedRequest has settings merged from the :class: Request <Request> instance and those of the :class: Session . </> put ( url , data , **kwargs ) \u2014 Sends a PUT request. Returns :class: Response object. </> rebuild_auth ( prepared_request , response ) \u2014 When being redirected we may want to strip authentication from the request to avoid leaking credentials. This method intelligently removes and reapplies authentication where possible to avoid credential loss. </> rebuild_method ( prepared_request , response ) \u2014 When being redirected we may want to change the method of the request based on certain specs or browser behavior. </> rebuild_proxies ( prepared_request , proxies ) \u2014 This method re-evaluates the proxy configuration by considering the environment variables. If we are redirected to a URL covered by NO_PROXY, we strip the proxy configuration. Otherwise, we set missing proxy keys for this URL (in case they were stripped by a previous redirect). </> request ( method , url , params , data , headers , cookies , files , auth , timeout , allow_redirects , proxies , hooks , stream , verify , cert , json ) \u2014 Constructs a :class: Request <Request> , prepares it and sends it. Returns :class: Response <Response> object. </> resolve_redirects ( resp , req , stream , timeout , verify , cert , proxies , yield_requests , **adapter_kwargs ) \u2014 Receives a Response. Returns a generator of Responses or Requests. </> search_brief_bib_other_editions ( oclcNumber , deweyNumber , datePublished , heldByGroup , heldBySymbol , heldByInstitutionID , inLanguage , inCatalogLanguage , materialType , catalogSource , itemType , itemSubType , retentionCommitments , spProgram , genre , topic , subtopic , audience , content , openAccess , peerReviewed , facets , groupVariantRecords , preferredLanguage , offset , limit , orderBy , hooks ) (Response) \u2014 Retrieve other editions related to bibliographic resource with provided OCLC #. Uses /brief-bibs/{oclcNumber}/other-editions endpoint. </> search_brief_bibs ( q , deweyNumber , datePublished , heldByGroup , inLanguage , inCatalogLanguage , materialType , catalogSource , itemType , itemSubType , retentionCommitments , spProgram , facets , groupRelatedEditions , groupVariantRecords , preferredLanguage , orderBy , offset , limit , hooks ) (Response) \u2014 Send a GET request for brief bibliographic resources. Uses /brief-bibs endpoint. </> search_current_control_numbers ( oclcNumbers , response_format , hooks ) (Response) \u2014 Retrieve current OCLC control numbers Uses /bib/checkcontrolnumbers endpoint. </> search_general_holdings ( oclcNumber , isbn , issn , holdingsAllEditions , holdingsAllVariantRecords , preferredLanguage , heldInCountry , heldByGroup , lat , lon , distance , unit , offset , limit , hooks ) (Response) \u2014 Given a known item gets summary of holdings. Uses /bibs-summary-holdings endpoint. </> search_shared_print_holdings ( oclcNumber , isbn , issn , heldByGroup , heldInState , itemType , itemSubType , offset , limit , hooks ) (Response) \u2014 Finds member shared print holdings for specified item. Uses /bibs-retained-holdings endpoint. </> send ( request , **kwargs ) \u2014 Send a given PreparedRequest. </> should_strip_auth ( old_url , new_url ) \u2014 Decide whether Authorization header should be removed when redirecting </> method get_redirect_target ( resp ) </> Receives a Response. Returns a redirect URI or None method should_strip_auth ( old_url , new_url ) </> Decide whether Authorization header should be removed when redirecting generator resolve_redirects ( resp , req , stream=False , timeout=None , verify=True , cert=None , proxies=None , yield_requests=False , **adapter_kwargs ) </> Receives a Response. Returns a generator of Responses or Requests. method rebuild_auth ( prepared_request , response ) </> When being redirected we may want to strip authentication from the request to avoid leaking credentials. This method intelligently removes and reapplies authentication where possible to avoid credential loss. method rebuild_proxies ( prepared_request , proxies ) </> This method re-evaluates the proxy configuration by considering the environment variables. If we are redirected to a URL covered by NO_PROXY, we strip the proxy configuration. Otherwise, we set missing proxy keys for this URL (in case they were stripped by a previous redirect). This method also replaces the Proxy-Authorization header where necessary. :rtype: dict method rebuild_method ( prepared_request , response ) </> When being redirected we may want to change the method of the request based on certain specs or browser behavior. method prepare_request ( request ) </> Constructs a :class: PreparedRequest <PreparedRequest> for transmission and returns it. The :class: PreparedRequest has settings merged from the :class: Request <Request> instance and those of the :class: Session . :param request: :class: Request instance to prepare with this session's settings. :rtype: requests.PreparedRequest method request ( method , url , params=None , data=None , headers=None , cookies=None , files=None , auth=None , timeout=None , allow_redirects=True , proxies=None , hooks=None , stream=None , verify=None , cert=None , json=None ) </> Constructs a :class: Request <Request> , prepares it and sends it. Returns :class: Response <Response> object. :param method: method for the new :class: Request object. :param url: URL for the new :class: Request object. :param params: (optional) Dictionary or bytes to be sent in the query string for the :class: Request . :param data: (optional) Dictionary, list of tuples, bytes, or file-like object to send in the body of the :class: Request . :param json: (optional) json to send in the body of the :class: Request . :param headers: (optional) Dictionary of HTTP Headers to send with the :class: Request . :param cookies: (optional) Dict or CookieJar object to send with the :class: Request . :param files: (optional) Dictionary of 'filename': file-like-objects for multipart encoding upload. :param auth: (optional) Auth tuple or callable to enable Basic/Digest/Custom HTTP Auth. :param timeout: (optional) How long to wait for the server to send data before giving up, as a float, or a :ref: (connect timeout, read timeout) <timeouts> tuple. :type timeout: float or tuple :param allow_redirects: (optional) Set to True by default. :type allow_redirects: bool :param proxies: (optional) Dictionary mapping protocol or protocol and hostname to the URL of the proxy. :param stream: (optional) whether to immediately download the response content. Defaults to False . :param verify: (optional) Either a boolean, in which case it controls whether we verify the server's TLS certificate, or a string, in which case it must be a path to a CA bundle to use. Defaults to True . When set to False , requests will accept any TLS certificate presented by the server, and will ignore hostname mismatches and/or expired certificates, which will make your application vulnerable to man-in-the-middle (MitM) attacks. Setting verify to False may be useful during local development or testing. :param cert: (optional) if String, path to ssl client cert file (.pem). If Tuple, ('cert', 'key') pair. :rtype: requests.Response method get ( url , **kwargs ) </> Sends a GET request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method options ( url , **kwargs ) </> Sends a OPTIONS request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method head ( url , **kwargs ) </> Sends a HEAD request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method post ( url , data=None , json=None , **kwargs ) </> Sends a POST request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param data: (optional) Dictionary, list of tuples, bytes, or file-like object to send in the body of the :class: Request . :param json: (optional) json to send in the body of the :class: Request . :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method put ( url , data=None , **kwargs ) </> Sends a PUT request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param data: (optional) Dictionary, list of tuples, bytes, or file-like object to send in the body of the :class: Request . :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method patch ( url , data=None , **kwargs ) </> Sends a PATCH request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param data: (optional) Dictionary, list of tuples, bytes, or file-like object to send in the body of the :class: Request . :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method delete ( url , **kwargs ) </> Sends a DELETE request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method send ( request , **kwargs ) </> Send a given PreparedRequest. :rtype: requests.Response method merge_environment_settings ( url , proxies , stream , verify , cert ) </> Check the environment and merge it with some settings. :rtype: dict method get_adapter ( url ) </> Returns the appropriate connection adapter for the given URL. :rtype: requests.adapters.BaseAdapter method close ( ) </> Closes all adapters and as such the session method mount ( prefix , adapter ) </> Registers a connection adapter to a prefix. Adapters are sorted in descending order by prefix length. method get_brief_bib ( oclcNumber , hooks=None ) </> Retrieve specific brief bibliographic resource. Uses /brief-bibs/{oclcNumber} endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string that can include OCLC # prefix hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response instance method get_full_bib ( oclcNumber , response_format=None , hooks=None ) </> Send a GET request for a full bibliographic resource. Uses /bib/data/{oclcNumber} endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix response_format (Optional, optional) \u2014 format of returned record hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method holding_get_status ( oclcNumber , inst=None , instSymbol=None , response_format='application/atom+json' , hooks=None ) </> Retrieves Worlcat holdings status of a record with provided OCLC number. The service automatically recognizes institution based on the issued access token. Uses /ih/checkholdings endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix inst (Optional, optional) \u2014 registry ID of the institution whose holdings are being checked instSymbol (Optional, optional) \u2014 optional; OCLC symbol of the institution whose holdings are being checked response_format (Optional, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method holding_set ( oclcNumber , inst=None , instSymbol=None , holdingLibraryCode=None , classificationScheme=None , response_format='application/atom+json' , hooks=None ) </> Sets institution's Worldcat holding on an individual record. Uses /ih/data endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix inst (Optional, optional) \u2014 registry ID of the institution whose holdings are being checked instSymbol (Optional, optional) \u2014 optional; OCLC symbol of the institution whose holdings are being checked holdingLibraryCode (Optional, optional) \u2014 four letter holding code to set the holing on classificationScheme (Optional, optional) \u2014 whether or not to return group availability information response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method holding_unset ( oclcNumber , cascade='0' , inst=None , instSymbol=None , holdingLibraryCode=None , classificationScheme=None , response_format='application/atom+json' , hooks=None ) </> Deletes institution's Worldcat holding on an individual record. Uses /ih/data endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix if str the numbers must be separated by comma cascade (Union, optional) \u2014 0 or 1, default 0; 0 - don't remove holdings if local holding record or local bibliographic records exists; 1 - remove holding and delete local holdings record and local bibliographic record inst (Optional, optional) \u2014 registry ID of the institution whose holdings are being checked instSymbol (Optional, optional) \u2014 optional; OCLC symbol of the institution whose holdings are being checked holdingLibraryCode (Optional, optional) \u2014 four letter holding code to set the holing on classificationScheme (Optional, optional) \u2014 whether or not to return group availability information response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method holdings_set ( oclcNumbers , inst=None , instSymbol=None , response_format='application/atom+json' , hooks=None ) </> Set institution holdings for multiple OCLC numbers Uses /ih/datalist endpoint. Parameters oclcNumbers (Union) \u2014 list of OCLC control numbers for which holdings should be set; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma inst (Optional, optional) \u2014 registry ID of the institution whose holdings are being checked instSymbol (Optional, optional) \u2014 optional; OCLC symbol of the institution whose holdings are being checked response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (List) list of requests.Response objects method holdings_unset ( oclcNumbers , cascade='0' , inst=None , instSymbol=None , response_format='application/atom+json' , hooks=None ) </> Set institution holdings for multiple OCLC numbers Uses /ih/datalist endpoint. Parameters oclcNumbers (Union) \u2014 list of OCLC control numbers for which holdings should be set; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma cascade (str, optional) \u2014 0 or 1, default 0; 0 - don't remove holdings if local holding record or local bibliographic records exists; 1 - remove holding and delete local holdings record and local bibliographic record inst (Optional, optional) \u2014 registry ID of the institution whose holdings are being checked instSymbol (Optional, optional) \u2014 optional; OCLC symbol of the institution whose holdings are being checked response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (List) list of requests.Response objects method holdings_set_multi_institutions ( oclcNumber , instSymbols , response_format='application/atom+json' , hooks=None ) </> Batch sets intitution holdings for multiple intitutions Uses /ih/institutionlist endpoint Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix instSymbols (str) \u2014 a comma-separated list of OCLC symbols of the institution whose holdings are being set response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method holdings_unset_multi_institutions ( oclcNumber , instSymbols , cascade='0' , response_format='application/atom+json' , hooks=None ) </> Batch unsets intitution holdings for multiple intitutions Uses /ih/institutionlist endpoint Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix instSymbols (str) \u2014 a comma-separated list of OCLC symbols of the institution whose holdings are being set cascade (str, optional) \u2014 0 or 1, default 0; 0 - don't remove holdings if local holding record or local bibliographic records exists; 1 - remove holding and delete local holdings record and local bibliographic record response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method search_brief_bib_other_editions ( oclcNumber , deweyNumber=None , datePublished=None , heldByGroup=None , heldBySymbol=None , heldByInstitutionID=None , inLanguage=None , inCatalogLanguage=None , materialType=None , catalogSource=None , itemType=None , itemSubType=None , retentionCommitments=None , spProgram=None , genre=None , topic=None , subtopic=None , audience=None , content=None , openAccess=None , peerReviewed=None , facets=None , groupVariantRecords=None , preferredLanguage=None , offset=None , limit=None , orderBy=None , hooks=None ) </> Retrieve other editions related to bibliographic resource with provided OCLC #. Uses /brief-bibs/{oclcNumber}/other-editions endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix deweyNumber (Optional, optional) \u2014 limits the response to the specified dewey classification number(s); for multiple values repeat the parameter, example: '794,180' datePublished (Optional, optional) \u2014 restricts the response to one or more dates, or to a range, examples: '2000' '2000-2005' '2000,2005' heldByGroup (Optional, optional) \u2014 restricts to holdings held by group symbol heldBySymbol (Optional, optional) \u2014 restricts to holdings with specified intitution symbol heldByInstitutionID (Union, optional) \u2014 restrict to specified institution regisgtryId inLanguage (Optional, optional) \u2014 restrics the response to the single specified language, example: 'fre' materialType (Optional, optional) \u2014 restricts responses to specified material type, example: 'bks', 'vis' catalogSource (Optional, optional) \u2014 restrict to responses to single OCLC symbol as the cataloging source, example: 'DLC' itemType (Optional, optional) \u2014 restricts reponses to single specified OCLC top-level facet type, example: 'book' itemSubType (Optional, optional) \u2014 restricts responses to single specified OCLC sub facet type, example: 'digital' retentionCommitments (Optional, optional) \u2014 restricts responses to bibliographic records with retention commitment; True or False, default False spProgram (Optional, optional) \u2014 restricts responses to bibliographic records associated with particular shared print program genre (Optional, optional) \u2014 genre to limit results to topic (Optional, optional) \u2014 topic to limit results to subtopic (Optional, optional) \u2014 subtopic to limit results to audience (Optional, optional) \u2014 audience to limit results to, example: juv, nonJuv content (Optional, optional) \u2014 content to limit resutls to, example: fic, nonFic, fic,bio openAccess (Optional, optional) \u2014 filter to only open access content, False or True peerReviewed (Optional, optional) \u2014 filter to only peer reviewed content, False or True facets (Optional, optional) \u2014 list of facets to restrict responses groupVariantRecords (Optional, optional) \u2014 whether or not to group variant records. options: False, True (default False) preferredLanguage (Optional, optional) \u2014 language of metadata description, offset (Optional, optional) \u2014 start position of bibliographic records to return; default 1 limit (Optional, optional) \u2014 maximum nuber of records to return; maximum 50, default 10 orderBy (Optional, optional) \u2014 sort of restuls; available values: +date, -date, +language, -language; default value: -date hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks inCataloglanguage \u2014 restrics the response to specified cataloging language, example: 'eng'; default 'eng' Returns (Response) requests.Response object method search_brief_bibs ( q , deweyNumber=None , datePublished=None , heldByGroup=None , inLanguage=None , inCatalogLanguage='eng' , materialType=None , catalogSource=None , itemType=None , itemSubType=None , retentionCommitments=None , spProgram=None , facets=None , groupRelatedEditions=None , groupVariantRecords=None , preferredLanguage=None , orderBy='mostWidelyHeld' , offset=None , limit=None , hooks=None ) </> Send a GET request for brief bibliographic resources. Uses /brief-bibs endpoint. Parameters q (str) \u2014 query in the form of a keyword search or fielded search; examples: ti:Zendegi ti:\"Czarne oceany\" bn:9781680502404 kw:python databases ti:Zendegi AND au:greg egan (au:Okken OR au:Myers) AND su:python deweyNumber (Optional, optional) \u2014 limits the response to the specified dewey classification number(s); for multiple values repeat the parameter, example: '794,180' datePublished (Optional, optional) \u2014 restricts the response to one or more dates, or to a range, examples: '2000' '2000-2005' '2000,2005' heldByGroup (Optional, optional) \u2014 restricts to holdings held by group symbol inLanguage (Optional, optional) \u2014 restrics the response to the single specified language, example: 'fre' materialType (Optional, optional) \u2014 restricts responses to specified material type, example: 'bks', 'vis' catalogSource (Optional, optional) \u2014 restrict to responses to single OCLC symbol as the cataloging source, example: 'DLC' itemType (Optional, optional) \u2014 restricts reponses to single specified OCLC top-level facet type, example: 'book' itemSubType (Optional, optional) \u2014 restricts responses to single specified OCLC sub facet type, example: 'digital' retentionCommitments (Optional, optional) \u2014 restricts responses to bibliographic records with retention commitment; True or False spProgram (Optional, optional) \u2014 restricts responses to bibliographic records associated with particular shared print program facets (Optional, optional) \u2014 list of facets to restrict responses groupRelatedEditions (Optional, optional) \u2014 whether or not use FRBR grouping, options: False, True (default is False) groupVariantRecords (Optional, optional) \u2014 whether or not to group variant records. options: False, True (default False) preferredLanguage (Optional, optional) \u2014 language of metadata description, default value \"en\" (English) orderBy (Optional, optional) \u2014 results sort key; options: 'recency' 'bestMatch' 'creator' 'library' 'publicationDateAsc' 'publicationDateDesc' 'mostWidelyHeld' 'title' offset (Optional, optional) \u2014 start position of bibliographic records to return; default 1 limit (Optional, optional) \u2014 maximum nuber of records to return; maximum 50, default 10 hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks inCataloglanguage \u2014 restrics the response to specified cataloging language, example: 'eng'; default 'eng' Returns (Response) requests.Response object method search_current_control_numbers ( oclcNumbers , response_format='application/atom+json' , hooks=None ) </> Retrieve current OCLC control numbers Uses /bib/checkcontrolnumbers endpoint. Parameters oclcNumbers (Union) \u2014 list of OCLC control numbers to be checked; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method search_general_holdings ( oclcNumber=None , isbn=None , issn=None , holdingsAllEditions=None , holdingsAllVariantRecords=None , preferredLanguage=None , heldInCountry=None , heldByGroup=None , lat=None , lon=None , distance=None , unit=None , offset=None , limit=None , hooks=None ) </> Given a known item gets summary of holdings. Uses /bibs-summary-holdings endpoint. Parameters oclcNumber (Union, optional) \u2014 OCLC bibliographic record number; can be an integer, or string that can include OCLC # prefix isbn (Optional, optional) \u2014 ISBN without any dashes, example: '978149191646x' issn (Optional, optional) \u2014 ISSN (hyphenated, example: '0099-1234') holdingsAllEditions (Optional, optional) \u2014 get holdings for all editions; options: True or False holdingsAllVariantRecords (Optional, optional) \u2014 get holdings for specific edition across variant records; options: False, True preferredLanguage (Optional, optional) \u2014 language of metadata description; default 'en' (English) heldInCountry (Optional, optional) \u2014 restricts to holdings held by institutions in requested country heldByGroup (Optional, optional) \u2014 limits to holdings held by indicated by symbol group lat (Optional, optional) \u2014 limit to latitude, example: 37.502508 lon (Optional, optional) \u2014 limit to longitute, example: -122.22702 distance (Optional, optional) \u2014 distance from latitude and longitude unit (Optional, optional) \u2014 unit of distance param; options: 'M' (miles) or 'K' (kilometers) offset (Optional, optional) \u2014 start position of bibliographic records to return; default 1 limit (Optional, optional) \u2014 maximum nuber of records to return; maximum 50, default 10 hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method search_shared_print_holdings ( oclcNumber=None , isbn=None , issn=None , heldByGroup=None , heldInState=None , itemType=None , itemSubType=None , offset=None , limit=None , hooks=None ) </> Finds member shared print holdings for specified item. Uses /bibs-retained-holdings endpoint. Parameters oclcNumber (Union, optional) \u2014 OCLC bibliographic record number; can be an integer, or string that can include OCLC # prefix isbn (Optional, optional) \u2014 ISBN without any dashes, example: '978149191646x' issn (Optional, optional) \u2014 ISSN (hyphenated, example: '0099-1234') heldByGroup (Optional, optional) \u2014 restricts to holdings held by group symbol heldInState (Optional, optional) \u2014 restricts to holings held by institutions in requested state, example: \"NY\" itemType (Optional, optional) \u2014 restricts results to specified item type (example 'book' or 'vis') itemSubType (Optional, optional) \u2014 restricts results to specified item sub type examples: 'book-digital' or 'audiobook-cd' offset (Optional, optional) \u2014 start position of bibliographic records to return; default 1 limit (Optional, optional) \u2014 maximum nuber of records to return; maximum 50, default 10 Returns (Response) requests.Response object","title":"bookops_worldcat.metadata_api"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_api","text":"</> This module provides MetadataSession class for requests to WorldCat Metadata API. Classes MetadataSession \u2014 OCLC Metadata API wrapper session. Inherits requests.Session methods </> class","title":"bookops_worldcat.metadata_api"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasession","text":"</> Bases bookops_worldcat._session.WorldcatSession requests.sessions.Session requests.sessions.SessionRedirectMixin OCLC Metadata API wrapper session. Inherits requests.Session methods Attributes auth \u2014 class: Request <Request> . cert \u2014 cert file (.pem). If Tuple, ('cert', 'key') pair. cookies \u2014 may be any other cookielib.CookieJar compatible object. headers \u2014 class: Session <Session> . hooks \u2014 Event-handling hooks. max_redirects \u2014 30. params \u2014 representing multivalued query parameters. proxies (be used on each) \u2014 class: Request <Request> . stream \u2014 Stream response content default. trust_env \u2014 authentication and similar. verify \u2014 Only set this to False for testing. Methods close ( ) \u2014 Closes all adapters and as such the session </> delete ( url , **kwargs ) \u2014 Sends a DELETE request. Returns :class: Response object. </> get ( url , **kwargs ) \u2014 Sends a GET request. Returns :class: Response object. </> get_adapter ( url ) \u2014 Returns the appropriate connection adapter for the given URL. </> get_brief_bib ( oclcNumber , hooks ) (Response) \u2014 Retrieve specific brief bibliographic resource. Uses /brief-bibs/{oclcNumber} endpoint. </> get_full_bib ( oclcNumber , response_format , hooks ) (Response) \u2014 Send a GET request for a full bibliographic resource. Uses /bib/data/{oclcNumber} endpoint. </> get_redirect_target ( resp ) \u2014 Receives a Response. Returns a redirect URI or None </> head ( url , **kwargs ) \u2014 Sends a HEAD request. Returns :class: Response object. </> holding_get_status ( oclcNumber , inst , instSymbol , response_format , hooks ) (Response) \u2014 Retrieves Worlcat holdings status of a record with provided OCLC number. The service automatically recognizes institution based on the issued access token. Uses /ih/checkholdings endpoint. </> holding_set ( oclcNumber , inst , instSymbol , holdingLibraryCode , classificationScheme , response_format , hooks ) (Response) \u2014 Sets institution's Worldcat holding on an individual record. Uses /ih/data endpoint. </> holding_unset ( oclcNumber , cascade , inst , instSymbol , holdingLibraryCode , classificationScheme , response_format , hooks ) (Response) \u2014 Deletes institution's Worldcat holding on an individual record. Uses /ih/data endpoint. </> holdings_set ( oclcNumbers , inst , instSymbol , response_format , hooks ) (List) \u2014 Set institution holdings for multiple OCLC numbers Uses /ih/datalist endpoint. </> holdings_set_multi_institutions ( oclcNumber , instSymbols , response_format , hooks ) (Response) \u2014 Batch sets intitution holdings for multiple intitutions </> holdings_unset ( oclcNumbers , cascade , inst , instSymbol , response_format , hooks ) (List) \u2014 Set institution holdings for multiple OCLC numbers Uses /ih/datalist endpoint. </> holdings_unset_multi_institutions ( oclcNumber , instSymbols , cascade , response_format , hooks ) (Response) \u2014 Batch unsets intitution holdings for multiple intitutions </> merge_environment_settings ( url , proxies , stream , verify , cert ) \u2014 Check the environment and merge it with some settings. </> mount ( prefix , adapter ) \u2014 Registers a connection adapter to a prefix. </> options ( url , **kwargs ) \u2014 Sends a OPTIONS request. Returns :class: Response object. </> patch ( url , data , **kwargs ) \u2014 Sends a PATCH request. Returns :class: Response object. </> post ( url , data , json , **kwargs ) \u2014 Sends a POST request. Returns :class: Response object. </> prepare_request ( request ) \u2014 Constructs a :class: PreparedRequest <PreparedRequest> for transmission and returns it. The :class: PreparedRequest has settings merged from the :class: Request <Request> instance and those of the :class: Session . </> put ( url , data , **kwargs ) \u2014 Sends a PUT request. Returns :class: Response object. </> rebuild_auth ( prepared_request , response ) \u2014 When being redirected we may want to strip authentication from the request to avoid leaking credentials. This method intelligently removes and reapplies authentication where possible to avoid credential loss. </> rebuild_method ( prepared_request , response ) \u2014 When being redirected we may want to change the method of the request based on certain specs or browser behavior. </> rebuild_proxies ( prepared_request , proxies ) \u2014 This method re-evaluates the proxy configuration by considering the environment variables. If we are redirected to a URL covered by NO_PROXY, we strip the proxy configuration. Otherwise, we set missing proxy keys for this URL (in case they were stripped by a previous redirect). </> request ( method , url , params , data , headers , cookies , files , auth , timeout , allow_redirects , proxies , hooks , stream , verify , cert , json ) \u2014 Constructs a :class: Request <Request> , prepares it and sends it. Returns :class: Response <Response> object. </> resolve_redirects ( resp , req , stream , timeout , verify , cert , proxies , yield_requests , **adapter_kwargs ) \u2014 Receives a Response. Returns a generator of Responses or Requests. </> search_brief_bib_other_editions ( oclcNumber , deweyNumber , datePublished , heldByGroup , heldBySymbol , heldByInstitutionID , inLanguage , inCatalogLanguage , materialType , catalogSource , itemType , itemSubType , retentionCommitments , spProgram , genre , topic , subtopic , audience , content , openAccess , peerReviewed , facets , groupVariantRecords , preferredLanguage , offset , limit , orderBy , hooks ) (Response) \u2014 Retrieve other editions related to bibliographic resource with provided OCLC #. Uses /brief-bibs/{oclcNumber}/other-editions endpoint. </> search_brief_bibs ( q , deweyNumber , datePublished , heldByGroup , inLanguage , inCatalogLanguage , materialType , catalogSource , itemType , itemSubType , retentionCommitments , spProgram , facets , groupRelatedEditions , groupVariantRecords , preferredLanguage , orderBy , offset , limit , hooks ) (Response) \u2014 Send a GET request for brief bibliographic resources. Uses /brief-bibs endpoint. </> search_current_control_numbers ( oclcNumbers , response_format , hooks ) (Response) \u2014 Retrieve current OCLC control numbers Uses /bib/checkcontrolnumbers endpoint. </> search_general_holdings ( oclcNumber , isbn , issn , holdingsAllEditions , holdingsAllVariantRecords , preferredLanguage , heldInCountry , heldByGroup , lat , lon , distance , unit , offset , limit , hooks ) (Response) \u2014 Given a known item gets summary of holdings. Uses /bibs-summary-holdings endpoint. </> search_shared_print_holdings ( oclcNumber , isbn , issn , heldByGroup , heldInState , itemType , itemSubType , offset , limit , hooks ) (Response) \u2014 Finds member shared print holdings for specified item. Uses /bibs-retained-holdings endpoint. </> send ( request , **kwargs ) \u2014 Send a given PreparedRequest. </> should_strip_auth ( old_url , new_url ) \u2014 Decide whether Authorization header should be removed when redirecting </> method","title":"bookops_worldcat.metadata_api.MetadataSession"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionredirectmixinget_redirect_target","text":"</> Receives a Response. Returns a redirect URI or None method","title":"requests.sessions.SessionRedirectMixin.get_redirect_target"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionredirectmixinshould_strip_auth","text":"</> Decide whether Authorization header should be removed when redirecting generator","title":"requests.sessions.SessionRedirectMixin.should_strip_auth"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionredirectmixinresolve_redirects","text":"</> Receives a Response. Returns a generator of Responses or Requests. method","title":"requests.sessions.SessionRedirectMixin.resolve_redirects"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionredirectmixinrebuild_auth","text":"</> When being redirected we may want to strip authentication from the request to avoid leaking credentials. This method intelligently removes and reapplies authentication where possible to avoid credential loss. method","title":"requests.sessions.SessionRedirectMixin.rebuild_auth"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionredirectmixinrebuild_proxies","text":"</> This method re-evaluates the proxy configuration by considering the environment variables. If we are redirected to a URL covered by NO_PROXY, we strip the proxy configuration. Otherwise, we set missing proxy keys for this URL (in case they were stripped by a previous redirect). This method also replaces the Proxy-Authorization header where necessary. :rtype: dict method","title":"requests.sessions.SessionRedirectMixin.rebuild_proxies"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionredirectmixinrebuild_method","text":"</> When being redirected we may want to change the method of the request based on certain specs or browser behavior. method","title":"requests.sessions.SessionRedirectMixin.rebuild_method"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionprepare_request","text":"</> Constructs a :class: PreparedRequest <PreparedRequest> for transmission and returns it. The :class: PreparedRequest has settings merged from the :class: Request <Request> instance and those of the :class: Session . :param request: :class: Request instance to prepare with this session's settings. :rtype: requests.PreparedRequest method","title":"requests.sessions.Session.prepare_request"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionrequest","text":"</> Constructs a :class: Request <Request> , prepares it and sends it. Returns :class: Response <Response> object. :param method: method for the new :class: Request object. :param url: URL for the new :class: Request object. :param params: (optional) Dictionary or bytes to be sent in the query string for the :class: Request . :param data: (optional) Dictionary, list of tuples, bytes, or file-like object to send in the body of the :class: Request . :param json: (optional) json to send in the body of the :class: Request . :param headers: (optional) Dictionary of HTTP Headers to send with the :class: Request . :param cookies: (optional) Dict or CookieJar object to send with the :class: Request . :param files: (optional) Dictionary of 'filename': file-like-objects for multipart encoding upload. :param auth: (optional) Auth tuple or callable to enable Basic/Digest/Custom HTTP Auth. :param timeout: (optional) How long to wait for the server to send data before giving up, as a float, or a :ref: (connect timeout, read timeout) <timeouts> tuple. :type timeout: float or tuple :param allow_redirects: (optional) Set to True by default. :type allow_redirects: bool :param proxies: (optional) Dictionary mapping protocol or protocol and hostname to the URL of the proxy. :param stream: (optional) whether to immediately download the response content. Defaults to False . :param verify: (optional) Either a boolean, in which case it controls whether we verify the server's TLS certificate, or a string, in which case it must be a path to a CA bundle to use. Defaults to True . When set to False , requests will accept any TLS certificate presented by the server, and will ignore hostname mismatches and/or expired certificates, which will make your application vulnerable to man-in-the-middle (MitM) attacks. Setting verify to False may be useful during local development or testing. :param cert: (optional) if String, path to ssl client cert file (.pem). If Tuple, ('cert', 'key') pair. :rtype: requests.Response method","title":"requests.sessions.Session.request"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionget","text":"</> Sends a GET request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method","title":"requests.sessions.Session.get"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionoptions","text":"</> Sends a OPTIONS request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method","title":"requests.sessions.Session.options"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionhead","text":"</> Sends a HEAD request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method","title":"requests.sessions.Session.head"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionpost","text":"</> Sends a POST request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param data: (optional) Dictionary, list of tuples, bytes, or file-like object to send in the body of the :class: Request . :param json: (optional) json to send in the body of the :class: Request . :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method","title":"requests.sessions.Session.post"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionput","text":"</> Sends a PUT request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param data: (optional) Dictionary, list of tuples, bytes, or file-like object to send in the body of the :class: Request . :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method","title":"requests.sessions.Session.put"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionpatch","text":"</> Sends a PATCH request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param data: (optional) Dictionary, list of tuples, bytes, or file-like object to send in the body of the :class: Request . :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method","title":"requests.sessions.Session.patch"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessiondelete","text":"</> Sends a DELETE request. Returns :class: Response object. :param url: URL for the new :class: Request object. :param **kwargs: Optional arguments that request takes. :rtype: requests.Response method","title":"requests.sessions.Session.delete"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionsend","text":"</> Send a given PreparedRequest. :rtype: requests.Response method","title":"requests.sessions.Session.send"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionmerge_environment_settings","text":"</> Check the environment and merge it with some settings. :rtype: dict method","title":"requests.sessions.Session.merge_environment_settings"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionget_adapter","text":"</> Returns the appropriate connection adapter for the given URL. :rtype: requests.adapters.BaseAdapter method","title":"requests.sessions.Session.get_adapter"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionclose","text":"</> Closes all adapters and as such the session method","title":"requests.sessions.Session.close"},{"location":"api/bookops_worldcat.metadata_api/#requestssessionssessionmount","text":"</> Registers a connection adapter to a prefix. Adapters are sorted in descending order by prefix length. method","title":"requests.sessions.Session.mount"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionget_brief_bib","text":"</> Retrieve specific brief bibliographic resource. Uses /brief-bibs/{oclcNumber} endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string that can include OCLC # prefix hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response instance method","title":"bookops_worldcat.metadata_api.MetadataSession.get_brief_bib"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionget_full_bib","text":"</> Send a GET request for a full bibliographic resource. Uses /bib/data/{oclcNumber} endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix response_format (Optional, optional) \u2014 format of returned record hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method","title":"bookops_worldcat.metadata_api.MetadataSession.get_full_bib"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionholding_get_status","text":"</> Retrieves Worlcat holdings status of a record with provided OCLC number. The service automatically recognizes institution based on the issued access token. Uses /ih/checkholdings endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix inst (Optional, optional) \u2014 registry ID of the institution whose holdings are being checked instSymbol (Optional, optional) \u2014 optional; OCLC symbol of the institution whose holdings are being checked response_format (Optional, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method","title":"bookops_worldcat.metadata_api.MetadataSession.holding_get_status"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionholding_set","text":"</> Sets institution's Worldcat holding on an individual record. Uses /ih/data endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix inst (Optional, optional) \u2014 registry ID of the institution whose holdings are being checked instSymbol (Optional, optional) \u2014 optional; OCLC symbol of the institution whose holdings are being checked holdingLibraryCode (Optional, optional) \u2014 four letter holding code to set the holing on classificationScheme (Optional, optional) \u2014 whether or not to return group availability information response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method","title":"bookops_worldcat.metadata_api.MetadataSession.holding_set"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionholding_unset","text":"</> Deletes institution's Worldcat holding on an individual record. Uses /ih/data endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix if str the numbers must be separated by comma cascade (Union, optional) \u2014 0 or 1, default 0; 0 - don't remove holdings if local holding record or local bibliographic records exists; 1 - remove holding and delete local holdings record and local bibliographic record inst (Optional, optional) \u2014 registry ID of the institution whose holdings are being checked instSymbol (Optional, optional) \u2014 optional; OCLC symbol of the institution whose holdings are being checked holdingLibraryCode (Optional, optional) \u2014 four letter holding code to set the holing on classificationScheme (Optional, optional) \u2014 whether or not to return group availability information response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method","title":"bookops_worldcat.metadata_api.MetadataSession.holding_unset"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionholdings_set","text":"</> Set institution holdings for multiple OCLC numbers Uses /ih/datalist endpoint. Parameters oclcNumbers (Union) \u2014 list of OCLC control numbers for which holdings should be set; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma inst (Optional, optional) \u2014 registry ID of the institution whose holdings are being checked instSymbol (Optional, optional) \u2014 optional; OCLC symbol of the institution whose holdings are being checked response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (List) list of requests.Response objects method","title":"bookops_worldcat.metadata_api.MetadataSession.holdings_set"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionholdings_unset","text":"</> Set institution holdings for multiple OCLC numbers Uses /ih/datalist endpoint. Parameters oclcNumbers (Union) \u2014 list of OCLC control numbers for which holdings should be set; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma cascade (str, optional) \u2014 0 or 1, default 0; 0 - don't remove holdings if local holding record or local bibliographic records exists; 1 - remove holding and delete local holdings record and local bibliographic record inst (Optional, optional) \u2014 registry ID of the institution whose holdings are being checked instSymbol (Optional, optional) \u2014 optional; OCLC symbol of the institution whose holdings are being checked response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (List) list of requests.Response objects method","title":"bookops_worldcat.metadata_api.MetadataSession.holdings_unset"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionholdings_set_multi_institutions","text":"</> Batch sets intitution holdings for multiple intitutions Uses /ih/institutionlist endpoint Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix instSymbols (str) \u2014 a comma-separated list of OCLC symbols of the institution whose holdings are being set response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method","title":"bookops_worldcat.metadata_api.MetadataSession.holdings_set_multi_institutions"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionholdings_unset_multi_institutions","text":"</> Batch unsets intitution holdings for multiple intitutions Uses /ih/institutionlist endpoint Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix instSymbols (str) \u2014 a comma-separated list of OCLC symbols of the institution whose holdings are being set cascade (str, optional) \u2014 0 or 1, default 0; 0 - don't remove holdings if local holding record or local bibliographic records exists; 1 - remove holding and delete local holdings record and local bibliographic record response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method","title":"bookops_worldcat.metadata_api.MetadataSession.holdings_unset_multi_institutions"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionsearch_brief_bib_other_editions","text":"</> Retrieve other editions related to bibliographic resource with provided OCLC #. Uses /brief-bibs/{oclcNumber}/other-editions endpoint. Parameters oclcNumber (Union) \u2014 OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix deweyNumber (Optional, optional) \u2014 limits the response to the specified dewey classification number(s); for multiple values repeat the parameter, example: '794,180' datePublished (Optional, optional) \u2014 restricts the response to one or more dates, or to a range, examples: '2000' '2000-2005' '2000,2005' heldByGroup (Optional, optional) \u2014 restricts to holdings held by group symbol heldBySymbol (Optional, optional) \u2014 restricts to holdings with specified intitution symbol heldByInstitutionID (Union, optional) \u2014 restrict to specified institution regisgtryId inLanguage (Optional, optional) \u2014 restrics the response to the single specified language, example: 'fre' materialType (Optional, optional) \u2014 restricts responses to specified material type, example: 'bks', 'vis' catalogSource (Optional, optional) \u2014 restrict to responses to single OCLC symbol as the cataloging source, example: 'DLC' itemType (Optional, optional) \u2014 restricts reponses to single specified OCLC top-level facet type, example: 'book' itemSubType (Optional, optional) \u2014 restricts responses to single specified OCLC sub facet type, example: 'digital' retentionCommitments (Optional, optional) \u2014 restricts responses to bibliographic records with retention commitment; True or False, default False spProgram (Optional, optional) \u2014 restricts responses to bibliographic records associated with particular shared print program genre (Optional, optional) \u2014 genre to limit results to topic (Optional, optional) \u2014 topic to limit results to subtopic (Optional, optional) \u2014 subtopic to limit results to audience (Optional, optional) \u2014 audience to limit results to, example: juv, nonJuv content (Optional, optional) \u2014 content to limit resutls to, example: fic, nonFic, fic,bio openAccess (Optional, optional) \u2014 filter to only open access content, False or True peerReviewed (Optional, optional) \u2014 filter to only peer reviewed content, False or True facets (Optional, optional) \u2014 list of facets to restrict responses groupVariantRecords (Optional, optional) \u2014 whether or not to group variant records. options: False, True (default False) preferredLanguage (Optional, optional) \u2014 language of metadata description, offset (Optional, optional) \u2014 start position of bibliographic records to return; default 1 limit (Optional, optional) \u2014 maximum nuber of records to return; maximum 50, default 10 orderBy (Optional, optional) \u2014 sort of restuls; available values: +date, -date, +language, -language; default value: -date hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks inCataloglanguage \u2014 restrics the response to specified cataloging language, example: 'eng'; default 'eng' Returns (Response) requests.Response object method","title":"bookops_worldcat.metadata_api.MetadataSession.search_brief_bib_other_editions"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionsearch_brief_bibs","text":"</> Send a GET request for brief bibliographic resources. Uses /brief-bibs endpoint. Parameters q (str) \u2014 query in the form of a keyword search or fielded search; examples: ti:Zendegi ti:\"Czarne oceany\" bn:9781680502404 kw:python databases ti:Zendegi AND au:greg egan (au:Okken OR au:Myers) AND su:python deweyNumber (Optional, optional) \u2014 limits the response to the specified dewey classification number(s); for multiple values repeat the parameter, example: '794,180' datePublished (Optional, optional) \u2014 restricts the response to one or more dates, or to a range, examples: '2000' '2000-2005' '2000,2005' heldByGroup (Optional, optional) \u2014 restricts to holdings held by group symbol inLanguage (Optional, optional) \u2014 restrics the response to the single specified language, example: 'fre' materialType (Optional, optional) \u2014 restricts responses to specified material type, example: 'bks', 'vis' catalogSource (Optional, optional) \u2014 restrict to responses to single OCLC symbol as the cataloging source, example: 'DLC' itemType (Optional, optional) \u2014 restricts reponses to single specified OCLC top-level facet type, example: 'book' itemSubType (Optional, optional) \u2014 restricts responses to single specified OCLC sub facet type, example: 'digital' retentionCommitments (Optional, optional) \u2014 restricts responses to bibliographic records with retention commitment; True or False spProgram (Optional, optional) \u2014 restricts responses to bibliographic records associated with particular shared print program facets (Optional, optional) \u2014 list of facets to restrict responses groupRelatedEditions (Optional, optional) \u2014 whether or not use FRBR grouping, options: False, True (default is False) groupVariantRecords (Optional, optional) \u2014 whether or not to group variant records. options: False, True (default False) preferredLanguage (Optional, optional) \u2014 language of metadata description, default value \"en\" (English) orderBy (Optional, optional) \u2014 results sort key; options: 'recency' 'bestMatch' 'creator' 'library' 'publicationDateAsc' 'publicationDateDesc' 'mostWidelyHeld' 'title' offset (Optional, optional) \u2014 start position of bibliographic records to return; default 1 limit (Optional, optional) \u2014 maximum nuber of records to return; maximum 50, default 10 hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks inCataloglanguage \u2014 restrics the response to specified cataloging language, example: 'eng'; default 'eng' Returns (Response) requests.Response object method","title":"bookops_worldcat.metadata_api.MetadataSession.search_brief_bibs"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionsearch_current_control_numbers","text":"</> Retrieve current OCLC control numbers Uses /bib/checkcontrolnumbers endpoint. Parameters oclcNumbers (Union) \u2014 list of OCLC control numbers to be checked; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma response_format (str, optional) \u2014 'application/atom+json' (default) or 'application/atom+xml' hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method","title":"bookops_worldcat.metadata_api.MetadataSession.search_current_control_numbers"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionsearch_general_holdings","text":"</> Given a known item gets summary of holdings. Uses /bibs-summary-holdings endpoint. Parameters oclcNumber (Union, optional) \u2014 OCLC bibliographic record number; can be an integer, or string that can include OCLC # prefix isbn (Optional, optional) \u2014 ISBN without any dashes, example: '978149191646x' issn (Optional, optional) \u2014 ISSN (hyphenated, example: '0099-1234') holdingsAllEditions (Optional, optional) \u2014 get holdings for all editions; options: True or False holdingsAllVariantRecords (Optional, optional) \u2014 get holdings for specific edition across variant records; options: False, True preferredLanguage (Optional, optional) \u2014 language of metadata description; default 'en' (English) heldInCountry (Optional, optional) \u2014 restricts to holdings held by institutions in requested country heldByGroup (Optional, optional) \u2014 limits to holdings held by indicated by symbol group lat (Optional, optional) \u2014 limit to latitude, example: 37.502508 lon (Optional, optional) \u2014 limit to longitute, example: -122.22702 distance (Optional, optional) \u2014 distance from latitude and longitude unit (Optional, optional) \u2014 unit of distance param; options: 'M' (miles) or 'K' (kilometers) offset (Optional, optional) \u2014 start position of bibliographic records to return; default 1 limit (Optional, optional) \u2014 maximum nuber of records to return; maximum 50, default 10 hooks (Optional, optional) \u2014 Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns (Response) requests.Response object method","title":"bookops_worldcat.metadata_api.MetadataSession.search_general_holdings"},{"location":"api/bookops_worldcat.metadata_api/#bookops_worldcatmetadata_apimetadatasessionsearch_shared_print_holdings","text":"</> Finds member shared print holdings for specified item. Uses /bibs-retained-holdings endpoint. Parameters oclcNumber (Union, optional) \u2014 OCLC bibliographic record number; can be an integer, or string that can include OCLC # prefix isbn (Optional, optional) \u2014 ISBN without any dashes, example: '978149191646x' issn (Optional, optional) \u2014 ISSN (hyphenated, example: '0099-1234') heldByGroup (Optional, optional) \u2014 restricts to holdings held by group symbol heldInState (Optional, optional) \u2014 restricts to holings held by institutions in requested state, example: \"NY\" itemType (Optional, optional) \u2014 restricts results to specified item type (example 'book' or 'vis') itemSubType (Optional, optional) \u2014 restricts results to specified item sub type examples: 'book-digital' or 'audiobook-cd' offset (Optional, optional) \u2014 start position of bibliographic records to return; default 1 limit (Optional, optional) \u2014 maximum nuber of records to return; maximum 50, default 10 Returns (Response) requests.Response object","title":"bookops_worldcat.metadata_api.MetadataSession.search_shared_print_holdings"},{"location":"api/bookops_worldcat.query/","text":"module bookops_worldcat . query </> Handles actual requests to OCLC services Classes Query \u2014 Sends a request to OClC service and unifies received exceptions Query object handles refreshing expired token before request is made to the web service. </> class bookops_worldcat.query . Query ( session , prepared_request , timeout=None ) </> Sends a request to OClC service and unifies received exceptions Query object handles refreshing expired token before request is made to the web service. Query.response attribute is requests.Response instance that can be parsed to exctract received information from the web service.","title":"bookops_worldcat.query"},{"location":"api/bookops_worldcat.query/#bookops_worldcatquery","text":"</> Handles actual requests to OCLC services Classes Query \u2014 Sends a request to OClC service and unifies received exceptions Query object handles refreshing expired token before request is made to the web service. </> class","title":"bookops_worldcat.query"},{"location":"api/bookops_worldcat.query/#bookops_worldcatqueryquery","text":"</> Sends a request to OClC service and unifies received exceptions Query object handles refreshing expired token before request is made to the web service. Query.response attribute is requests.Response instance that can be parsed to exctract received information from the web service.","title":"bookops_worldcat.query.Query"},{"location":"api/bookops_worldcat.utils/","text":"module bookops_worldcat . utils </> Shared utilities module. Functions prep_oclc_number_str ( oclcNumber ) (str) \u2014 Checks for OCLC prefixes and removes them. </> verify_oclc_number ( oclcNumber ) (str) \u2014 Verifies a valid looking OCLC number is passed and normalize it as integer. </> verify_oclc_numbers ( oclcNumbers ) (vetted_numbers) \u2014 Parses and verifies list of oclcNumbers </> function bookops_worldcat.utils . prep_oclc_number_str ( oclcNumber ) </> Checks for OCLC prefixes and removes them. Parameters oclcNumber (str) \u2014 OCLC record as string Returns (str) oclcNumber as int function bookops_worldcat.utils . verify_oclc_number ( oclcNumber ) </> Verifies a valid looking OCLC number is passed and normalize it as integer. Parameters oclcNumber (Union) \u2014 OCLC record number Returns (str) oclcNumber function bookops_worldcat.utils . verify_oclc_numbers ( oclcNumbers ) </> Parses and verifies list of oclcNumbers Parameters oclcNumbers (Union) \u2014 list of OCLC control numbers for which holdings should be set; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma Returns (vetted_numbers) list of vetted oclcNumbers","title":"bookops_worldcat.utils"},{"location":"api/bookops_worldcat.utils/#bookops_worldcatutils","text":"</> Shared utilities module. Functions prep_oclc_number_str ( oclcNumber ) (str) \u2014 Checks for OCLC prefixes and removes them. </> verify_oclc_number ( oclcNumber ) (str) \u2014 Verifies a valid looking OCLC number is passed and normalize it as integer. </> verify_oclc_numbers ( oclcNumbers ) (vetted_numbers) \u2014 Parses and verifies list of oclcNumbers </> function","title":"bookops_worldcat.utils"},{"location":"api/bookops_worldcat.utils/#bookops_worldcatutilsprep_oclc_number_str","text":"</> Checks for OCLC prefixes and removes them. Parameters oclcNumber (str) \u2014 OCLC record as string Returns (str) oclcNumber as int function","title":"bookops_worldcat.utils.prep_oclc_number_str"},{"location":"api/bookops_worldcat.utils/#bookops_worldcatutilsverify_oclc_number","text":"</> Verifies a valid looking OCLC number is passed and normalize it as integer. Parameters oclcNumber (Union) \u2014 OCLC record number Returns (str) oclcNumber function","title":"bookops_worldcat.utils.verify_oclc_number"},{"location":"api/bookops_worldcat.utils/#bookops_worldcatutilsverify_oclc_numbers","text":"</> Parses and verifies list of oclcNumbers Parameters oclcNumbers (Union) \u2014 list of OCLC control numbers for which holdings should be set; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma Returns (vetted_numbers) list of vetted oclcNumbers","title":"bookops_worldcat.utils.verify_oclc_numbers"},{"location":"api/source/bookops_worldcat.authorize/","text":"SOURCE CODE bookops_worldcat. authorize DOCS # -*- coding: utf-8 -*- \"\"\" This module provides means to authenticate and obtain a WorldCat access token. \"\"\" import datetime import sys from typing import Dict , List , Optional , Tuple , Union import requests from requests import Response from . import __title__ , __version__ # type: ignore from .errors import WorldcatAuthorizationError class WorldcatAccessToken : DOCS \"\"\" Requests Worldcat access token. Authenticates and authorizes using Client Credentials Grant. Does not support Explicit Authorization Code and Refresh Token flows. Token with correctly bonded scopes can then be passed into a session of particular web service to authorize requests for resources. More on OCLC's web services authorization: https://www.oclc.org/developer/develop/authentication/oauth/client-credentials-grant.en.html Args: key: your WSKey public client_id secret: your WSKey secret scopes: request scopes for the access token principal_id: principalID (required for read/write endpoints) principal_idns: principalIDNS (required for read/write endpoints) agent: \"User-agent\" parameter to be passed in the request header; usage strongly encouraged timeout: how long to wait for server to send data before giving up; default value is 3 seconds Examples: >>> from bookops_worldcat import WorldcatAccessToken >>> token = WorldcatAccessToken( key=\"my_WSKey_client_id\", secret=\"my_WSKey_secret\", scope=\"WorldCatMetadataAPI\", principal_id=\"your principalID here\", principal_idns=\"your principalIDNS here\", agent=\"my_app/1.0.0\") >>> token.token_str \"tk_Yebz4BpEp9dAsghA7KpWx6dYD1OZKWBlHjqW\" >>> token.is_expired() False >>> token.server_response.json() {\"token_token\": \"tk_Yebz4BpEp9dAsghA7KpWx6dYD1OZKWBlHjqW\", \"token_type\": \"bearer\", \"expires_in\": \"1199\", \"principalID\": \"\", \"principalIDNS\": \"\", \"scopes\": \"WorldCatMetadataAPI\", \"contextInstitutionId\": \"00001\", \"expires_at\": \"2020-08-23 18:45:29Z\"} >>> token.server_response.request.headers {\"User-Agent\": \"my_app/1.0.0\", \"Accept-Encoding\": \"gzip, deflate\", \"Accept\": \"application/json\", \"Connection\": \"keep-alive\", \"Content-Length\": \"67\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic encoded_authorization_here=\"} \"\"\" def __init__ ( self , key : str , secret : str , scopes : Union [ str , List [ str ]], principal_id : str , principal_idns : str , agent : Optional [ str ] = None , timeout : Optional [ Union [ int , float , Tuple [ int , int ], Tuple [ float , float ]] ] = None , ) -> None : \"\"\"Constructor\"\"\" self . agent = agent self . grant_type = \"client_credentials\" self . key = key self . oauth_server = \"https://oauth.oclc.org\" self . principal_id = principal_id self . principal_idns = principal_idns self . scopes = scopes self . secret = secret self . server_response = None self . timeout = timeout self . token_expires_at = None self . token_str = None self . token_type = None # default bookops-worldcat request header if self . agent is None : self . agent = f \" { __title__ } / { __version__ } \" else : if type ( self . agent ) is not str : raise WorldcatAuthorizationError ( \"Argument 'agent' must be a string.\" ) # asure passed arguments are valid if not self . key : raise WorldcatAuthorizationError ( \"Argument 'key' is required.\" ) else : if type ( self . key ) is not str : raise WorldcatAuthorizationError ( \"Argument 'key' must be a string.\" ) if not self . secret : raise WorldcatAuthorizationError ( \"Argument 'secret' is required.\" ) else : if type ( self . secret ) is not str : raise WorldcatAuthorizationError ( \"Argument 'secret' must be a string.\" ) if not self . principal_id : raise WorldcatAuthorizationError ( \"Argument 'principal_id' is required for read/write endpoint of Metadata API.\" ) if not self . principal_idns : raise WorldcatAuthorizationError ( \"Argument 'principal_idns' is required for read/write endpoint of Metadata API.\" ) # validate passed scopes if type ( self . scopes ) is list : self . scopes = \" \" . join ( self . scopes ) elif type ( self . scopes ) is not str : raise WorldcatAuthorizationError ( \"Argument 'scopes' must a string or a list.\" ) self . scopes = self . scopes . strip () # type: ignore if self . scopes == \"\" : raise WorldcatAuthorizationError ( \"Argument 'scope' is missing.\" ) # assign default value for timout if not self . timeout : self . timeout = ( 3 , 3 ) # initiate request self . _request_token () def _auth ( self ) -> Tuple [ str , str ]: return ( self . key , self . secret ) def _hasten_expiration_time ( self , utc_stamp_str : str ) -> str : \"\"\" Resets expiration time one second earlier to account for any delays between expiration check and request for new token in session setting. Args: utcstamp: utc timestamp string Returns: utcstamp \"\"\" utcstamp = datetime . datetime . strptime ( utc_stamp_str , \"%Y-%m- %d %H:%M:%SZ\" ) - datetime . timedelta ( seconds = 1 ) return datetime . datetime . strftime ( utcstamp , \"%Y-%m- %d %H:%M:%SZ\" ) def _parse_server_response ( self , response : Response ) -> None : \"\"\"Parses authorization server response\"\"\" self . server_response = response # type: ignore if response . status_code == requests . codes . ok : self . token_str = response . json ()[ \"access_token\" ] self . token_expires_at = self . _hasten_expiration_time ( # type: ignore response . json ()[ \"expires_at\" ] ) self . token_type = response . json ()[ \"token_type\" ] else : raise WorldcatAuthorizationError ( response . content ) def _payload ( self ) -> Dict [ str , str ]: \"\"\"Preps requests params\"\"\" return { \"grant_type\" : self . grant_type , \"scope\" : self . scopes , # type: ignore \"principalID\" : self . principal_id , \"principalIDNS\" : self . principal_idns , } def _post_token_request ( self ) -> Response : \"\"\" Fetches Worldcat access token for specified scope (web service) Returns: requests.models.Response \"\"\" token_url = self . _token_url () headers = self . _token_headers () auth = self . _auth () payload = self . _payload () try : response = requests . post ( token_url , auth = auth , headers = headers , params = payload , timeout = self . timeout , ) return response except ( requests . exceptions . Timeout , requests . exceptions . ConnectionError ): raise WorldcatAuthorizationError ( f \"Trouble connecting: { sys . exc_info ()[ 0 ] } \" ) except Exception : raise WorldcatAuthorizationError ( f \"Unexpected error: { sys . exc_info ()[ 0 ] } \" ) def _request_token ( self ): \"\"\" Initiates access token request and parses the response if successful. \"\"\" response = self . _post_token_request () self . _parse_server_response ( response ) def _token_headers ( self ) -> Dict [ str , str ]: return { \"User-Agent\" : self . agent , \"Accept\" : \"application/json\" } # type: ignore def _token_url ( self ) -> str : return f \" { self . oauth_server } /token\" def is_expired ( self ) -> bool : DOCS \"\"\" Checks if the access token is expired. Returns: bool Example: >>> token.is_expired() False \"\"\" try : if ( datetime . datetime . strptime ( self . token_expires_at , \"%Y-%m- %d %H:%M:%SZ\" ) # type: ignore < datetime . datetime . utcnow () ): return True else : return False except TypeError : raise except ValueError : raise def __repr__ ( self ): return ( f \"access_token: ' { self . token_str } ', expires_at: ' { self . token_expires_at } '\" )","title":"bookops_worldcat.authorize"},{"location":"api/source/bookops_worldcat.errors/","text":"SOURCE CODE bookops_worldcat. errors DOCS # -*- coding: utf-8 -*- \"\"\" This module contains the set of bookops_worldcat exceptions. \"\"\" class BookopsWorldcatError ( Exception ): DOCS \"\"\"Base class for exceptions in this module.\"\"\" pass class WorldcatAuthorizationError ( BookopsWorldcatError ): DOCS \"\"\" Exception raised when WorldCat access token is not obtained \"\"\" pass class WorldcatSessionError ( BookopsWorldcatError ): DOCS \"\"\" Exception raised during WorlCat session \"\"\" pass class WorldcatRequestError ( WorldcatSessionError ): DOCS \"\"\" Exceptions raised on HTTP errors returned by web service \"\"\" pass class InvalidOclcNumber ( BookopsWorldcatError ): DOCS \"\"\" Exception raised when an invalid OCLC record number is encountered \"\"\" pass","title":"bookops_worldcat.errors"},{"location":"api/source/bookops_worldcat/","text":"SOURCE CODE bookops_worldcat DOCS from .__version__ import __title__ , __version__ from .authorize import WorldcatAccessToken from .metadata_api import MetadataSession","title":"bookops_worldcat"},{"location":"api/source/bookops_worldcat.metadata_api/","text":"SOURCE CODE bookops_worldcat. metadata_api DOCS # -*- coding: utf-8 -*- \"\"\" This module provides MetadataSession class for requests to WorldCat Metadata API. \"\"\" from typing import Callable , Dict , List , Optional , Tuple , Union from requests import Request , Response from ._session import WorldcatSession from .authorize import WorldcatAccessToken from .errors import ( WorldcatSessionError , InvalidOclcNumber , ) from .query import Query from .utils import verify_oclc_number , verify_oclc_numbers class MetadataSession ( WorldcatSession ): DOCS \"\"\"OCLC Metadata API wrapper session. Inherits `requests.Session` methods\"\"\" def __init__ ( self , authorization : WorldcatAccessToken , agent : Optional [ str ] = None , timeout : Optional [ Union [ int , float , Tuple [ int , int ], Tuple [ float , float ]] ] = None , ) -> None : \"\"\" Args: authorization: WorlcatAccessToken object agent: \"User-agent\" parameter to be passed in the request header; usage strongly encouraged timeout: how long to wait for server to send data before giving up; default value is 5 seconds \"\"\" super () . __init__ ( authorization , agent = agent , timeout = timeout ) def _split_into_legal_volume ( self , oclc_numbers : List [ str ] = [], n : int = 50 ) -> List [ str ]: \"\"\" OCLC requries that no more than 50 numbers are passed for batch processing Args: oclc_numbers: list of oclc numbers n: batch size, default (max) 50 Yields: n-sized batch \"\"\" for i in range ( 0 , len ( oclc_numbers ), n ): yield \",\" . join ( oclc_numbers [ i : i + n ]) def _url_base ( self ) -> str : return \"https://worldcat.org\" def _url_search_base ( self ) -> str : return \"https://americas.metadata.api.oclc.org/worldcat/search/v1\" def _url_member_shared_print_holdings ( self ) -> str : base_url = self . _url_search_base () return f \" { base_url } /bibs-retained-holdings\" def _url_member_general_holdings ( self ) -> str : base_url = self . _url_search_base () return f \" { base_url } /bibs-summary-holdings\" def _url_brief_bib_search ( self ) -> str : base_url = self . _url_search_base () return f \" { base_url } /brief-bibs\" def _url_brief_bib_oclc_number ( self , oclcNumber : str ) -> str : base_url = self . _url_search_base () return f \" { base_url } /brief-bibs/ { oclcNumber } \" def _url_brief_bib_other_editions ( self , oclcNumber : str ) -> str : base_url = self . _url_search_base () return f \" { base_url } /brief-bibs/ { oclcNumber } /other-editions\" def _url_lhr_control_number ( self , controlNumber : str ) -> str : base_url = self . _url_search_base () return f \" { base_url } /my-holdings/ { controlNumber } \" def _url_lhr_search ( self ) -> str : base_url = self . _url_search_base () return f \" { base_url } /my-holdings\" def _url_lhr_shared_print ( self ) -> str : base_url = self . _url_search_base () return f \" { base_url } /retained-holdings\" def _url_bib_oclc_number ( self , oclcNumber : str ) -> str : base_url = self . _url_base () return f \" { base_url } /bib/data/ { oclcNumber } \" def _url_bib_check_oclc_numbers ( self ) -> str : base_url = self . _url_base () return f \" { base_url } /bib/checkcontrolnumbers\" def _url_bib_holding_libraries ( self ) -> str : base_url = self . _url_base () return f \" { base_url } /bib/holdinglibraries\" def _url_bib_holdings_action ( self ) -> str : base_url = self . _url_base () return f \" { base_url } /ih/data\" def _url_bib_holdings_check ( self ) -> str : base_url = self . _url_base () return f \" { base_url } /ih/checkholdings\" def _url_bib_holdings_batch_action ( self ) -> str : base_url = self . _url_base () return f \" { base_url } /ih/datalist\" def _url_bib_holdings_multi_institution_batch_action ( self ) -> str : base_url = self . _url_base () return f \" { base_url } /ih/institutionlist\" def get_brief_bib ( DOCS self , oclcNumber : Union [ int , str ], hooks : Optional [ Dict [ str , Callable ]] = None ) -> Response : \"\"\" Retrieve specific brief bibliographic resource. Uses /brief-bibs/{oclcNumber} endpoint. Args: oclcNumber: OCLC bibliographic record number; can be an integer, or string that can include OCLC # prefix hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` instance \"\"\" try : oclcNumber = verify_oclc_number ( oclcNumber ) except InvalidOclcNumber : raise WorldcatSessionError ( \"Invalid OCLC # was passed as an argument\" ) header = { \"Accept\" : \"application/json\" } url = self . _url_brief_bib_oclc_number ( oclcNumber ) # prep request req = Request ( \"GET\" , url , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def get_full_bib ( DOCS self , oclcNumber : Union [ int , str ], response_format : Optional [ str ] = None , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Send a GET request for a full bibliographic resource. Uses /bib/data/{oclcNumber} endpoint. Args: oclcNumber: OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix response_format: format of returned record hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` object \"\"\" try : oclcNumber = verify_oclc_number ( oclcNumber ) except InvalidOclcNumber : raise WorldcatSessionError ( \"Invalid OCLC # was passed as an argument.\" ) url = self . _url_bib_oclc_number ( oclcNumber ) if not response_format : response_format = ( 'application/atom+xml;content=\"application/vnd.oclc.marc21+xml\"' ) header = { \"Accept\" : response_format } # prep request req = Request ( \"GET\" , url , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def holding_get_status ( DOCS self , oclcNumber : Union [ int , str ], inst : Optional [ str ] = None , instSymbol : Optional [ str ] = None , response_format : Optional [ str ] = \"application/atom+json\" , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Retrieves Worlcat holdings status of a record with provided OCLC number. The service automatically recognizes institution based on the issued access token. Uses /ih/checkholdings endpoint. Args: oclcNumber: OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix inst: registry ID of the institution whose holdings are being checked instSymbol: optional; OCLC symbol of the institution whose holdings are being checked response_format: 'application/atom+json' (default) or 'application/atom+xml' hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` object \"\"\" try : oclcNumber = verify_oclc_number ( oclcNumber ) except InvalidOclcNumber as exc : raise WorldcatSessionError ( exc ) url = self . _url_bib_holdings_check () header = { \"Accept\" : response_format } payload = { \"oclcNumber\" : oclcNumber , \"inst\" : inst , \"instSymbol\" : instSymbol } # prep request req = Request ( \"GET\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def holding_set ( DOCS self , oclcNumber : Union [ int , str ], inst : Optional [ str ] = None , instSymbol : Optional [ str ] = None , holdingLibraryCode : Optional [ str ] = None , classificationScheme : Optional [ str ] = None , response_format : str = \"application/atom+json\" , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Sets institution's Worldcat holding on an individual record. Uses /ih/data endpoint. Args: oclcNumber: OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix inst: registry ID of the institution whose holdings are being checked instSymbol: optional; OCLC symbol of the institution whose holdings are being checked holdingLibraryCode: four letter holding code to set the holing on classificationScheme: whether or not to return group availability information response_format: 'application/atom+json' (default) or 'application/atom+xml' hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` object \"\"\" try : oclcNumber = verify_oclc_number ( oclcNumber ) except InvalidOclcNumber as exc : raise WorldcatSessionError ( exc ) url = self . _url_bib_holdings_action () header = { \"Accept\" : response_format } payload = { \"oclcNumber\" : oclcNumber , \"inst\" : inst , \"instSymbol\" : instSymbol , \"holdingLibraryCode\" : holdingLibraryCode , \"classificationScheme\" : classificationScheme , } # prep request req = Request ( \"POST\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def holding_unset ( DOCS self , oclcNumber : Union [ int , str ], cascade : Union [ int , str ] = \"0\" , inst : Optional [ str ] = None , instSymbol : Optional [ str ] = None , holdingLibraryCode : Optional [ str ] = None , classificationScheme : Optional [ str ] = None , response_format : str = \"application/atom+json\" , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Deletes institution's Worldcat holding on an individual record. Uses /ih/data endpoint. Args: oclcNumber: OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix if str the numbers must be separated by comma cascade: 0 or 1, default 0; 0 - don't remove holdings if local holding record or local bibliographic records exists; 1 - remove holding and delete local holdings record and local bibliographic record inst: registry ID of the institution whose holdings are being checked instSymbol: optional; OCLC symbol of the institution whose holdings are being checked holdingLibraryCode: four letter holding code to set the holing on classificationScheme: whether or not to return group availability information response_format: 'application/atom+json' (default) or 'application/atom+xml' hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` object \"\"\" try : oclcNumber = verify_oclc_number ( oclcNumber ) except InvalidOclcNumber as exc : raise WorldcatSessionError ( exc ) url = self . _url_bib_holdings_action () header = { \"Accept\" : response_format } payload = { \"oclcNumber\" : oclcNumber , \"cascade\" : cascade , \"inst\" : inst , \"instSymbol\" : instSymbol , \"holdingLibraryCode\" : holdingLibraryCode , \"classificationScheme\" : classificationScheme , } # prep request req = Request ( \"DELETE\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def holdings_set ( DOCS self , oclcNumbers : Union [ str , List ], inst : Optional [ str ] = None , instSymbol : Optional [ str ] = None , response_format : str = \"application/atom+json\" , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> List [ Response ]: \"\"\" Set institution holdings for multiple OCLC numbers Uses /ih/datalist endpoint. Args: oclcNumbers: list of OCLC control numbers for which holdings should be set; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma inst: registry ID of the institution whose holdings are being checked instSymbol: optional; OCLC symbol of the institution whose holdings are being checked response_format: 'application/atom+json' (default) or 'application/atom+xml' hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: list of `requests.Response` objects \"\"\" responses = [] try : vetted_numbers = verify_oclc_numbers ( oclcNumbers ) except InvalidOclcNumber as exc : raise WorldcatSessionError ( exc ) url = self . _url_bib_holdings_batch_action () header = { \"Accept\" : response_format } # split into batches of 50 and issue request for each batch for batch in self . _split_into_legal_volume ( vetted_numbers ): payload = { \"oclcNumbers\" : batch , \"inst\" : inst , \"instSymbol\" : instSymbol , } # prep request req = Request ( \"POST\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) responses . append ( query . response ) return responses def holdings_unset ( DOCS self , oclcNumbers : Union [ str , List ], cascade : str = \"0\" , inst : Optional [ str ] = None , instSymbol : Optional [ str ] = None , response_format : str = \"application/atom+json\" , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> List [ Response ]: \"\"\" Set institution holdings for multiple OCLC numbers Uses /ih/datalist endpoint. Args: oclcNumbers: list of OCLC control numbers for which holdings should be set; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma cascade: 0 or 1, default 0; 0 - don't remove holdings if local holding record or local bibliographic records exists; 1 - remove holding and delete local holdings record and local bibliographic record inst: registry ID of the institution whose holdings are being checked instSymbol: optional; OCLC symbol of the institution whose holdings are being checked response_format: 'application/atom+json' (default) or 'application/atom+xml' hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: list of `requests.Response` objects \"\"\" responses = [] try : vetted_numbers = verify_oclc_numbers ( oclcNumbers ) except InvalidOclcNumber as exc : raise WorldcatSessionError ( exc ) url = self . _url_bib_holdings_batch_action () header = { \"Accept\" : response_format } # split into batches of 50 and issue request for each batch for batch in self . _split_into_legal_volume ( vetted_numbers ): payload = { \"oclcNumbers\" : batch , \"cascade\" : cascade , \"inst\" : inst , \"instSymbol\" : instSymbol , } # prep request req = Request ( \"DELETE\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) responses . append ( query . response ) return responses def holdings_set_multi_institutions ( DOCS self , oclcNumber : Union [ int , str ], instSymbols : str , response_format : str = \"application/atom+json\" , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Batch sets intitution holdings for multiple intitutions Uses /ih/institutionlist endpoint Args: oclcNumber: OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix instSymbols: a comma-separated list of OCLC symbols of the institution whose holdings are being set response_format: 'application/atom+json' (default) or 'application/atom+xml' hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` object \"\"\" try : oclcNumber = verify_oclc_number ( oclcNumber ) except InvalidOclcNumber : raise WorldcatSessionError ( \"Invalid OCLC # was passed as an argument\" ) url = self . _url_bib_holdings_multi_institution_batch_action () header = { \"Accept\" : response_format } payload = { \"oclcNumber\" : oclcNumber , \"instSymbols\" : instSymbols , } # prep request req = Request ( \"POST\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def holdings_unset_multi_institutions ( DOCS self , oclcNumber : Union [ int , str ], instSymbols : str , cascade : str = \"0\" , response_format : str = \"application/atom+json\" , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Batch unsets intitution holdings for multiple intitutions Uses /ih/institutionlist endpoint Args: oclcNumber: OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix instSymbols: a comma-separated list of OCLC symbols of the institution whose holdings are being set cascade: 0 or 1, default 0; 0 - don't remove holdings if local holding record or local bibliographic records exists; 1 - remove holding and delete local holdings record and local bibliographic record response_format: 'application/atom+json' (default) or 'application/atom+xml' hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` object \"\"\" try : oclcNumber = verify_oclc_number ( oclcNumber ) except InvalidOclcNumber : raise WorldcatSessionError ( \"Invalid OCLC # was passed as an argument\" ) url = self . _url_bib_holdings_multi_institution_batch_action () header = { \"Accept\" : response_format } payload = { \"oclcNumber\" : oclcNumber , \"instSymbols\" : instSymbols , \"cascade\" : cascade , } # prep request req = Request ( \"DELETE\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def search_brief_bib_other_editions ( DOCS self , oclcNumber : Union [ int , str ], deweyNumber : Optional [ str ] = None , datePublished : Optional [ str ] = None , heldByGroup : Optional [ str ] = None , heldBySymbol : Optional [ str ] = None , heldByInstitutionID : Optional [ Union [ str , int ]] = None , inLanguage : Optional [ str ] = None , inCatalogLanguage : Optional [ str ] = None , materialType : Optional [ str ] = None , catalogSource : Optional [ str ] = None , itemType : Optional [ str ] = None , itemSubType : Optional [ str ] = None , retentionCommitments : Optional [ bool ] = None , spProgram : Optional [ str ] = None , genre : Optional [ str ] = None , topic : Optional [ str ] = None , subtopic : Optional [ str ] = None , audience : Optional [ str ] = None , content : Optional [ str ] = None , openAccess : Optional [ bool ] = None , peerReviewed : Optional [ bool ] = None , facets : Optional [ str ] = None , groupVariantRecords : Optional [ bool ] = None , preferredLanguage : Optional [ str ] = None , offset : Optional [ int ] = None , limit : Optional [ int ] = None , orderBy : Optional [ str ] = None , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Retrieve other editions related to bibliographic resource with provided OCLC #. Uses /brief-bibs/{oclcNumber}/other-editions endpoint. Args: oclcNumber: OCLC bibliographic record number; can be an integer, or string with or without OCLC # prefix deweyNumber: limits the response to the specified dewey classification number(s); for multiple values repeat the parameter, example: '794,180' datePublished: restricts the response to one or more dates, or to a range, examples: '2000' '2000-2005' '2000,2005' heldByGroup: restricts to holdings held by group symbol heldBySymbol: restricts to holdings with specified intitution symbol heldByInstitutionID: restrict to specified institution regisgtryId inLanguage: restrics the response to the single specified language, example: 'fre' inCataloglanguage: restrics the response to specified cataloging language, example: 'eng'; default 'eng' materialType: restricts responses to specified material type, example: 'bks', 'vis' catalogSource: restrict to responses to single OCLC symbol as the cataloging source, example: 'DLC' itemType: restricts reponses to single specified OCLC top-level facet type, example: 'book' itemSubType: restricts responses to single specified OCLC sub facet type, example: 'digital' retentionCommitments: restricts responses to bibliographic records with retention commitment; True or False, default False spProgram: restricts responses to bibliographic records associated with particular shared print program genre: genre to limit results to topic: topic to limit results to subtopic: subtopic to limit results to audience: audience to limit results to, example: juv, nonJuv content: content to limit resutls to, example: fic, nonFic, fic,bio openAccess: filter to only open access content, False or True peerReviewed: filter to only peer reviewed content, False or True facets: list of facets to restrict responses groupVariantRecords: whether or not to group variant records. options: False, True (default False) preferredLanguage: language of metadata description, offset: start position of bibliographic records to return; default 1 limit: maximum nuber of records to return; maximum 50, default 10 orderBy: sort of restuls; available values: +date, -date, +language, -language; default value: -date hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` object \"\"\" try : oclcNumber = verify_oclc_number ( oclcNumber ) except InvalidOclcNumber : raise WorldcatSessionError ( \"Invalid OCLC # was passed as an argument\" ) url = self . _url_brief_bib_other_editions ( oclcNumber ) header = { \"Accept\" : \"application/json\" } payload = { \"deweyNumber\" : deweyNumber , \"datePublished\" : datePublished , \"heldByGroup\" : heldByGroup , \"heldBySymbol\" : heldBySymbol , \"heldByInstitutionID\" : heldByInstitutionID , \"inLanguage\" : inLanguage , \"inCatalogLanguage\" : inCatalogLanguage , \"catalogSource\" : catalogSource , \"itemType\" : itemType , \"itemSubType\" : itemSubType , \"retentionCommitments\" : retentionCommitments , \"spProgram\" : spProgram , \"genre\" : genre , \"topic\" : topic , \"subtopic\" : subtopic , \"audience\" : audience , \"content\" : content , \"openAccess\" : openAccess , \"peerReviewed\" : peerReviewed , \"facets\" : facets , \"groupVariantRecords\" : groupVariantRecords , \"preferredLanguage\" : preferredLanguage , \"offset\" : offset , \"limit\" : limit , \"orderBy\" : orderBy , } # prep request req = Request ( \"GET\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def search_brief_bibs ( DOCS self , q : str , deweyNumber : Optional [ str ] = None , datePublished : Optional [ str ] = None , heldByGroup : Optional [ str ] = None , inLanguage : Optional [ str ] = None , inCatalogLanguage : Optional [ str ] = \"eng\" , materialType : Optional [ str ] = None , catalogSource : Optional [ str ] = None , itemType : Optional [ str ] = None , itemSubType : Optional [ str ] = None , retentionCommitments : Optional [ bool ] = None , spProgram : Optional [ str ] = None , facets : Optional [ str ] = None , groupRelatedEditions : Optional [ bool ] = None , groupVariantRecords : Optional [ bool ] = None , preferredLanguage : Optional [ str ] = None , orderBy : Optional [ str ] = \"mostWidelyHeld\" , offset : Optional [ int ] = None , limit : Optional [ int ] = None , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Send a GET request for brief bibliographic resources. Uses /brief-bibs endpoint. Args: q: query in the form of a keyword search or fielded search; examples: ti:Zendegi ti:\"Czarne oceany\" bn:9781680502404 kw:python databases ti:Zendegi AND au:greg egan (au:Okken OR au:Myers) AND su:python deweyNumber: limits the response to the specified dewey classification number(s); for multiple values repeat the parameter, example: '794,180' datePublished: restricts the response to one or more dates, or to a range, examples: '2000' '2000-2005' '2000,2005' heldByGroup: restricts to holdings held by group symbol inLanguage: restrics the response to the single specified language, example: 'fre' inCataloglanguage: restrics the response to specified cataloging language, example: 'eng'; default 'eng' materialType: restricts responses to specified material type, example: 'bks', 'vis' catalogSource: restrict to responses to single OCLC symbol as the cataloging source, example: 'DLC' itemType: restricts reponses to single specified OCLC top-level facet type, example: 'book' itemSubType: restricts responses to single specified OCLC sub facet type, example: 'digital' retentionCommitments: restricts responses to bibliographic records with retention commitment; True or False spProgram: restricts responses to bibliographic records associated with particular shared print program facets: list of facets to restrict responses groupRelatedEditions: whether or not use FRBR grouping, options: False, True (default is False) groupVariantRecords: whether or not to group variant records. options: False, True (default False) preferredLanguage: language of metadata description, default value \"en\" (English) orderBy: results sort key; options: 'recency' 'bestMatch' 'creator' 'library' 'publicationDateAsc' 'publicationDateDesc' 'mostWidelyHeld' 'title' offset: start position of bibliographic records to return; default 1 limit: maximum nuber of records to return; maximum 50, default 10 hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` object \"\"\" if not q : raise WorldcatSessionError ( \"Argument 'q' is requried to construct query.\" ) url = self . _url_brief_bib_search () header = { \"Accept\" : \"application/json\" } payload = { \"q\" : q , \"deweyNumber\" : deweyNumber , \"datePublished\" : datePublished , \"heldByGroup\" : heldByGroup , \"inLanguage\" : inLanguage , \"inCatalogLanguage\" : inCatalogLanguage , \"materialType\" : materialType , \"catalogSource\" : catalogSource , \"itemType\" : itemType , \"itemSubType\" : itemSubType , \"retentionCommitments\" : retentionCommitments , \"spProgram\" : spProgram , \"facets\" : facets , \"groupRelatedEditions\" : groupRelatedEditions , \"groupVariantRecords\" : groupVariantRecords , \"preferredLanguage\" : preferredLanguage , \"orderBy\" : orderBy , \"offset\" : offset , \"limit\" : limit , } # prep request req = Request ( \"GET\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def search_current_control_numbers ( DOCS self , oclcNumbers : Union [ str , List [ Union [ str , int ]]], response_format : str = \"application/atom+json\" , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Retrieve current OCLC control numbers Uses /bib/checkcontrolnumbers endpoint. Args: oclcNumbers: list of OCLC control numbers to be checked; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma response_format: 'application/atom+json' (default) or 'application/atom+xml' hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` object \"\"\" try : vetted_numbers = verify_oclc_numbers ( oclcNumbers ) except InvalidOclcNumber as exc : raise WorldcatSessionError ( exc ) header = { \"Accept\" : response_format } url = self . _url_bib_check_oclc_numbers () payload = { \"oclcNumbers\" : \",\" . join ( vetted_numbers )} # prep request req = Request ( \"GET\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def search_general_holdings ( DOCS self , oclcNumber : Union [ int , str ] = None , isbn : Optional [ str ] = None , issn : Optional [ str ] = None , holdingsAllEditions : Optional [ bool ] = None , holdingsAllVariantRecords : Optional [ bool ] = None , preferredLanguage : Optional [ str ] = None , heldInCountry : Optional [ str ] = None , heldByGroup : Optional [ str ] = None , lat : Optional [ float ] = None , lon : Optional [ float ] = None , distance : Optional [ int ] = None , unit : Optional [ str ] = None , offset : Optional [ int ] = None , limit : Optional [ int ] = None , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Given a known item gets summary of holdings. Uses /bibs-summary-holdings endpoint. Args: oclcNumber: OCLC bibliographic record number; can be an integer, or string that can include OCLC # prefix isbn: ISBN without any dashes, example: '978149191646x' issn: ISSN (hyphenated, example: '0099-1234') holdingsAllEditions: get holdings for all editions; options: True or False holdingsAllVariantRecords: get holdings for specific edition across variant records; options: False, True preferredLanguage: language of metadata description; default 'en' (English) heldInCountry: restricts to holdings held by institutions in requested country heldByGroup: limits to holdings held by indicated by symbol group lat: limit to latitude, example: 37.502508 lon: limit to longitute, example: -122.22702 distance: distance from latitude and longitude unit: unit of distance param; options: 'M' (miles) or 'K' (kilometers) offset: start position of bibliographic records to return; default 1 limit: maximum nuber of records to return; maximum 50, default 10 hooks: Requests library hook system that can be used for signal event handling, see more at: https://requests.readthedocs.io/en/master/user/advanced/#event-hooks Returns: `requests.Response` object \"\"\" if not any ([ oclcNumber , isbn , issn ]): raise WorldcatSessionError ( \"Missing required argument. \" \"One of the following args are required: oclcNumber, issn, isbn\" ) if oclcNumber is not None : try : oclcNumber = verify_oclc_number ( oclcNumber ) except InvalidOclcNumber : raise WorldcatSessionError ( \"Invalid OCLC # was passed as an argument\" ) url = self . _url_member_general_holdings () header = { \"Accept\" : \"application/json\" } payload = { \"oclcNumber\" : oclcNumber , \"isbn\" : isbn , \"issn\" : issn , \"holdingsAllEditions\" : holdingsAllEditions , \"holdingsAllVariantRecords\" : holdingsAllVariantRecords , \"preferredLanguage\" : preferredLanguage , \"heldInCountry\" : heldInCountry , \"heldByGroup\" : heldByGroup , \"lat\" : lat , \"lon\" : lon , \"distance\" : distance , \"unit\" : unit , \"offset\" : offset , \"limit\" : limit , } # prep request req = Request ( \"GET\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response def search_shared_print_holdings ( DOCS self , oclcNumber : Union [ int , str ] = None , isbn : Optional [ str ] = None , issn : Optional [ str ] = None , heldByGroup : Optional [ str ] = None , heldInState : Optional [ str ] = None , itemType : Optional [ str ] = None , itemSubType : Optional [ str ] = None , offset : Optional [ int ] = None , limit : Optional [ int ] = None , hooks : Optional [ Dict [ str , Callable ]] = None , ) -> Response : \"\"\" Finds member shared print holdings for specified item. Uses /bibs-retained-holdings endpoint. Args: oclcNumber: OCLC bibliographic record number; can be an integer, or string that can include OCLC # prefix isbn: ISBN without any dashes, example: '978149191646x' issn: ISSN (hyphenated, example: '0099-1234') heldByGroup: restricts to holdings held by group symbol heldInState: restricts to holings held by institutions in requested state, example: \"NY\" itemType: restricts results to specified item type (example 'book' or 'vis') itemSubType: restricts results to specified item sub type examples: 'book-digital' or 'audiobook-cd' offset: start position of bibliographic records to return; default 1 limit: maximum nuber of records to return; maximum 50, default 10 \"\" Returns: `requests.Response` object \"\"\" if not any ([ oclcNumber , isbn , issn ]): raise WorldcatSessionError ( \"Missing required argument. \" \"One of the following args are required: oclcNumber, issn, isbn\" ) if oclcNumber is not None : try : oclcNumber = verify_oclc_number ( oclcNumber ) except InvalidOclcNumber : raise WorldcatSessionError ( \"Invalid OCLC # was passed as an argument\" ) url = self . _url_member_shared_print_holdings () header = { \"Accept\" : \"application/json\" } payload = { \"oclcNumber\" : oclcNumber , \"isbn\" : isbn , \"issn\" : issn , \"heldByGroup\" : heldByGroup , \"heldInState\" : heldInState , \"offset\" : offset , \"limit\" : limit , } # prep request req = Request ( \"GET\" , url , params = payload , headers = header , hooks = hooks ) prepared_request = self . prepare_request ( req ) # send request query = Query ( self , prepared_request , timeout = self . timeout ) return query . response","title":"bookops_worldcat.metadata_api"},{"location":"api/source/bookops_worldcat.query/","text":"SOURCE CODE bookops_worldcat. query DOCS # -*- coding: utf-8 -*- \"\"\" Handles actual requests to OCLC services \"\"\" from __future__ import annotations from typing import Optional , Union , Tuple , TYPE_CHECKING import sys from requests.models import PreparedRequest from requests.exceptions import ConnectionError , HTTPError , Timeout from .errors import WorldcatRequestError if TYPE_CHECKING : from .metadata_api import MetadataSession # pragma: no cover class Query : DOCS \"\"\" Sends a request to OClC service and unifies received exceptions Query object handles refreshing expired token before request is made to the web service. `Query.response` attribute is `requests.Response` instance that can be parsed to exctract received information from the web service. \"\"\" def __init__ ( self , session : MetadataSession , prepared_request : PreparedRequest , timeout : Optional [ Union [ int , float , Tuple [ int , int ], Tuple [ float , float ]] ] = None , ) -> None : \"\"\" Args: session: `metadata_api.MetadataSession` instance prepared_request: `requests.models.PreparedRequest` instance timeout: how long to wait for server to send data before giving up Raises: WorldcatRequestError \"\"\" if not isinstance ( prepared_request , PreparedRequest ): raise AttributeError ( \"Invalid type for argument 'prepared_request'.\" ) # make sure access token is still valid and if not request a new one if session . authorization . is_expired (): session . _get_new_access_token () self . response = None try : self . response = session . send ( prepared_request , timeout = timeout ) if \"/ih/data\" in prepared_request . url : if self . response . status_code == 409 : # HTTP 409 code returns when trying to set/unset # holdings on already set/unset record # It is reasonable not to raise any exceptions # in this case pass # pragma: no cover else : self . response . raise_for_status () else : self . response . raise_for_status () except HTTPError as exc : raise WorldcatRequestError ( f \" { exc } . Server response: { self . response . content } \" ) except ( Timeout , ConnectionError ): raise WorldcatRequestError ( f \"Connection Error: { sys . exc_info ()[ 0 ] } \" ) except : raise WorldcatRequestError ( f \"Unexpected request error: { sys . exc_info ()[ 0 ] } \" )","title":"bookops_worldcat.query"},{"location":"api/source/bookops_worldcat.utils/","text":"SOURCE CODE bookops_worldcat. utils DOCS # -*- coding: utf-8 -*- \"\"\" Shared utilities module. \"\"\" from typing import List , Union from .errors import InvalidOclcNumber def _str2list ( s : str ) -> List [ str ]: \"\"\"Converts str into list - use for list of OCLC numbers\"\"\" return [ n . strip () for n in s . split ( \",\" )] def prep_oclc_number_str ( oclcNumber : str ) -> str : DOCS \"\"\" Checks for OCLC prefixes and removes them. Args: oclcNumber: OCLC record as string Returns: oclcNumber as int \"\"\" if \"ocm\" in oclcNumber or \"ocn\" in oclcNumber : oclcNumber = oclcNumber . strip ()[ 3 :] elif \"on\" in oclcNumber : oclcNumber = oclcNumber . strip ()[ 2 :] try : oclcNumber = str ( int ( oclcNumber )) return oclcNumber except ValueError : raise InvalidOclcNumber ( \"Argument 'oclcNumber' does not look like real OCLC #.\" ) def verify_oclc_number ( oclcNumber : Union [ int , str ]) -> str : DOCS \"\"\" Verifies a valid looking OCLC number is passed and normalize it as integer. Args: oclcNumber: OCLC record number Returns: oclcNumber \"\"\" if oclcNumber is None : raise InvalidOclcNumber ( \"Argument 'oclcNumber' is missing.\" ) elif type ( oclcNumber ) is int : return str ( oclcNumber ) elif type ( oclcNumber ) is str : return prep_oclc_number_str ( oclcNumber ) # type: ignore else : raise InvalidOclcNumber ( \"Argument 'oclc_number' is of invalid type.\" ) def verify_oclc_numbers ( oclcNumbers : Union [ str , List [ Union [ str , int ]]]) -> List [ str ]: DOCS \"\"\" Parses and verifies list of oclcNumbers Args: oclcNumbers: list of OCLC control numbers for which holdings should be set; they can be integers or strings with or without OCLC # prefix; if str the numbers must be separated by comma Returns: vetted_numbers: list of vetted oclcNumbers \"\"\" # change to list if comma separated string if type ( oclcNumbers ) is str and oclcNumbers != \"\" : oclcNumbers = _str2list ( oclcNumbers ) # type: ignore if not oclcNumbers or type ( oclcNumbers ) is not list : raise InvalidOclcNumber ( \"Argument 'oclcNumbers' must be a list or comma separated string of valid OCLC #.\" ) try : vetted_numbers = [ str ( verify_oclc_number ( n )) for n in oclcNumbers ] return vetted_numbers except InvalidOclcNumber : raise InvalidOclcNumber ( \"One of passed OCLC #s is invalid.\" )","title":"bookops_worldcat.utils"}]}