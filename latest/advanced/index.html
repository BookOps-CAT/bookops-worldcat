
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation of BookOps-Worldcat library">
      
      
      
        <link rel="canonical" href="https://bookops-cat.github.io/bookops-worldcat/latest/advanced/">
      
      
        <link rel="prev" href="../local/">
      
      
        <link rel="next" href="../about/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>Advanced Usage - BookOps-Worldcat Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="NYPL" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#advanced-usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="BookOps-Worldcat Documentation" class="md-header__button md-logo" aria-label="BookOps-Worldcat Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BookOps-Worldcat Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Advanced Usage
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/BookOps-CAT/bookops-worldcat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    bookops-worldcat
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href=".." class="md-tabs__link">
          
  
  BookOps-WorldCat

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/authorize/" class="md-tabs__link">
          
  
  API Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../tutorials/" class="md-tabs__link">
        
  
    
  
  Tutorials

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="BookOps-Worldcat Documentation" class="md-nav__button md-logo" aria-label="BookOps-Worldcat Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    BookOps-Worldcat Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/BookOps-CAT/bookops-worldcat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    bookops-worldcat
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    BookOps-WorldCat
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            BookOps-WorldCat
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    How To
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            How To
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Search WorldCat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../manage_bibs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage Bibliographic Records
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../manage_holdings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage Institution Holdings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../local/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Search and Manage Local Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Advanced Usage
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Advanced Usage
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#oclc-number-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      OCLC Number Formatting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#worldcataccesstoken" class="md-nav__link">
    <span class="md-ellipsis">
      WorldcatAccessToken
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WorldcatAccessToken">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identifying-your-institution" class="md-nav__link">
    <span class="md-ellipsis">
      Identifying your institution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metadatasession" class="md-nav__link">
    <span class="md-ellipsis">
      MetadataSession
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MetadataSession">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#event-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Event hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#identifying-your-application" class="md-nav__link">
    <span class="md-ellipsis">
      Identifying your application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-token-refresh" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Token Refresh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retry-failed-requests" class="md-nav__link">
    <span class="md-ellipsis">
      Retry Failed Requests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About BookOps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    bookops_worldcat
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            bookops_worldcat
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/authorize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bookops_worldcat.authorize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bookops_worldcat.errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/metadata_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bookops_worldcat.metadata_api
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bookops_worldcat.query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bookops_worldcat.utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#oclc-number-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      OCLC Number Formatting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#worldcataccesstoken" class="md-nav__link">
    <span class="md-ellipsis">
      WorldcatAccessToken
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WorldcatAccessToken">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identifying-your-institution" class="md-nav__link">
    <span class="md-ellipsis">
      Identifying your institution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metadatasession" class="md-nav__link">
    <span class="md-ellipsis">
      MetadataSession
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MetadataSession">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#event-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Event hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#identifying-your-application" class="md-nav__link">
    <span class="md-ellipsis">
      Identifying your application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-token-refresh" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Token Refresh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retry-failed-requests" class="md-nav__link">
    <span class="md-ellipsis">
      Retry Failed Requests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="advanced-usage">Advanced Usage</h1>
<h2 id="oclc-number-formatting">OCLC Number Formatting</h2>
<p><code>MetadataSession</code> accepts OCLC numbers in methods' arguments as integers or strings. OCLC numbers will be parsed with or without a prefix (eg. "(OCoLC)", "ocm", "ocn", or "on") to ensure they correspond to <a href="https://help.oclc.org/Metadata_Services/WorldShare_Collection_Manager/Data_sync_collections/Prepare_your_data/30035_field_and_OCLC_control_numbers">OCLC's formatting rules</a> for OCLC control numbers. The following are all acceptable:</p>
<p><div class="language-python highlight"><span class="filename">Acceptable oclcNumber arguments</span><pre><span></span><code><span class="n">session</span><span class="o">.</span><span class="n">brief_bibs_get</span><span class="p">(</span><span class="n">oclcNumber</span><span class="o">=</span><span class="s2">&quot;ocm00012345&quot;</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">brief_bibs_search</span><span class="p">(</span><span class="n">oclcNumber</span><span class="o">=</span><span class="s2">&quot;00054321&quot;</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">bib_get_classification</span><span class="p">(</span><span class="n">oclcNumber</span><span class="o">=</span><span class="mi">12121</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">brief_bibs_search</span><span class="p">(</span><span class="n">oclcNumber</span><span class="o">=</span><span class="s2">&quot;(OCoLC)00054321&quot;</span><span class="p">)</span>
</code></pre></div>
The <code>bib_get_current_oclc_number</code> and <code>holdings_get_current</code> methods accept multiple OCLC Numbers passed to the <code>oclcNumbers</code> argument. For these methods OCLC Numbers can be passed as a list of strings and/or integers or a string with the numbers separated by commas. The <code>oclcNumbers</code> argument will also accept a single integer as a valid arguement. The following are all acceptable:</p>
<div class="language-python highlight"><span class="filename">Acceptable oclcNumbers arguments</span><pre><span></span><code><span class="n">session</span><span class="o">.</span><span class="n">holdings_get_current</span><span class="p">(</span><span class="n">oclcNumbers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ocm00012345&quot;</span><span class="p">,</span> <span class="s2">&quot;00012346&quot;</span><span class="p">,</span> <span class="s2">&quot;12347&quot;</span><span class="p">])</span>
<span class="n">session</span><span class="o">.</span><span class="n">holdings_get_current</span><span class="p">(</span><span class="n">oclcNumbers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ocm00012345&quot;</span><span class="p">,</span> <span class="s2">&quot;00012346&quot;</span><span class="p">,</span> <span class="mi">12347</span><span class="p">])</span>
<span class="n">session</span><span class="o">.</span><span class="n">bib_get_current_oclc_number</span><span class="p">(</span><span class="n">oclcNumbers</span><span class="o">=</span><span class="s2">&quot;ocm00012345, 00012346, 12347&quot;</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">bib_get_current_oclc_number</span><span class="p">(</span><span class="n">oclcNumbers</span><span class="o">=</span><span class="mi">12347</span><span class="p">)</span>
</code></pre></div>
<h2 id="authentication">Authentication</h2>
<h3 id="worldcataccesstoken">WorldcatAccessToken</h3>
<p>A <code>WorldcatAccessToken</code> object retains the underlying Requests object functionality (<a href="https://requests.readthedocs.io/en/latest/api/#requests.request"><code>requests.Request</code></a>) which can be accessed via the <code>.server_response</code> attribute:</p>
<p><div class="language-python highlight"><span class="filename">Obtaining an Access Token</span><pre><span></span><code><span class="kn">from</span> <span class="nn">bookops_worldcat</span> <span class="kn">import</span> <span class="n">WorldcatAccessToken</span>

<span class="n">token</span> <span class="o">=</span> <span class="n">WorldcatAccessToken</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;my_WSKey&quot;</span><span class="p">,</span>
    <span class="n">secret</span><span class="o">=</span><span class="s2">&quot;my_secret&quot;</span><span class="p">,</span>
    <span class="n">scopes</span><span class="o">=</span><span class="s2">&quot;WorldCatMetadataAPI&quot;</span><span class="p">,</span>
    <span class="n">agent</span><span class="o">=</span><span class="s2">&quot;my_app/version 1.0.0&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">server_response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
<span class="c1">#&gt;200</span>
<span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">server_response</span><span class="o">.</span><span class="n">elapsed</span><span class="p">):</span>
<span class="c1">#&gt;0:00:00.650108</span>
</code></pre></div>
Detailed information can be accessed using the <code>.json()</code> method.
<div class="language-json no-copy highlight"><span class="filename">token.server_response.json()</span><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;access_token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tk_TokenString&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nt">&quot;expires_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-03-14 19:52:37Z&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nt">&quot;authenticating_institution_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;00001&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nt">&quot;principalID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nt">&quot;context_institution_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;00001&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nt">&quot;scopes&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;WorldCatMetadataAPI:view_brief_bib&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;token_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bearer&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nt">&quot;expires_in&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1199</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="nt">&quot;principalIDNS&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="p">}</span>
</code></pre></div>
Users can check if the token has expired by calling the <code>is_expired</code> method:
<div class="language-python highlight"><span class="filename">token.is_expired()</span><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">is_expired</span><span class="p">())</span>
<span class="c1">#&gt;False</span>
</code></pre></div>
A failed token request raises a <code>WorldcatAuthorizationError</code> which provides the error code and detailed message returned by the server.</p>
<div class="language-python highlight"><span class="filename">WorldcatAuthorizationError</span><pre><span></span><code><span class="kn">from</span> <span class="nn">bookops_worldcat</span> <span class="kn">import</span> <span class="n">WorldcatAccessToken</span>

<span class="n">token</span> <span class="o">=</span> <span class="n">WorldcatAccessToken</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;my_WSKey&quot;</span><span class="p">,</span>
    <span class="n">secret</span><span class="o">=</span><span class="s2">&quot;my_secret&quot;</span><span class="p">,</span>
    <span class="n">scopes</span><span class="o">=</span><span class="s2">&quot;MetadataAPI&quot;</span><span class="p">,</span>
    <span class="n">agent</span><span class="o">=</span><span class="s2">&quot;my_app/version 1.0.0&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="c1">#&gt;bookops_worldcat.errors.WorldcatAuthorizationError: b&#39;{&quot;code&quot;:403,&quot;message&quot;:&quot;Invalid scope(s): MetadataAPI (MetadataAPI) [Invalid service specified, Not on key]&quot;}&#39;</span>
</code></pre></div>
<h4 id="identifying-your-institution">Identifying your institution</h4>
<p>Though uncommon, users can request that OCLC set up their WSKeys to allow them to work on behalf of multiple institutions. The user can then authenticate on behalf of any of the institutions associated with that WSKey. </p>
<p>If your WSKey is set up to work on behalf of multiple institutions, you can identify your institution when initiating a <code>WorldcatAccessToken</code> object. Pass the Registry ID for the institution you wish to work on behalf of to the scopes parameter as context.</p>
<div class="language-python highlight"><span class="filename">Access Token with Context</span><pre><span></span><code><span class="n">token</span> <span class="o">=</span> <span class="n">WorldcatAccessToken</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;my_WSKey&quot;</span><span class="p">,</span>
    <span class="n">secret</span><span class="o">=</span><span class="s2">&quot;my_secret&quot;</span><span class="p">,</span>
    <span class="n">scopes</span><span class="o">=</span><span class="s2">&quot;WorldCatMetadataAPI context:00001&quot;</span><span class="p">,</span>
    <span class="n">agent</span><span class="o">=</span><span class="s2">&quot;my_app/1.0.0&quot;</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="metadatasession">MetadataSession</h3>
<h4 id="event-hooks">Event hooks</h4>
<p><code>MetadataSession</code> methods support <a href="https://requests.readthedocs.io/en/latest/user/advanced/#event-hooks">Requests event hooks</a> which can be passed as an argument:</p>
<div class="language-python highlight"><span class="filename">Event Hooks</span><pre><span></span><code><span class="k">def</span> <span class="nf">print_url</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>

<span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;response&#39;</span><span class="p">:</span> <span class="n">print_url</span><span class="p">}</span>
<span class="n">session</span><span class="o">.</span><span class="n">brief_bibs_get</span><span class="p">(</span><span class="mi">850939579</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
<span class="c1">#&gt;https://metadata.api.oclc.org/worldcat/search/brief-bibs/850939579</span>
</code></pre></div>
<h4 id="identifying-your-application">Identifying your application</h4>
<p>BookOps-Worldcat provides a default <code>user-agent</code> value in the headers of all requests to OCLC web services: <code>bookops-worldcat/{version}</code>. Users are encouraged to update the <code>user-agent</code> value to properly identify your application to OCLC servers. This will provide a useful piece of information for OCLC staff if they need to assist with any troubleshooting problems that may arise.</p>
<p>To set a custom <code>user-agent</code> in a session simply pass it as an argument when initiating the session:
<div class="language-python highlight"><span class="filename">Custom user-agent</span><pre><span></span><code><span class="n">session</span> <span class="o">=</span> <span class="n">MetadataSession</span><span class="p">(</span><span class="n">authorization</span><span class="o">=</span><span class="n">token</span><span class="p">,</span> <span class="n">agent</span><span class="o">=</span><span class="s2">&quot;my_client_name&quot;</span><span class="p">)</span>
</code></pre></div></p>
<p>Alternatively, users can update the <code>.headers</code> attribute after initializing the session:
<div class="language-python highlight"><span class="filename">Update MetadataSession headers</span><pre><span></span><code><span class="n">session</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;user-agent&quot;</span><span class="p">:</span> <span class="s2">&quot;my-app/version 1.0&quot;</span><span class="p">})</span>
</code></pre></div></p>
<p>The <code>user-agent</code> header can be set for an access token request as well. To do that simply pass it as the <code>agent</code> parameter when initiating <code>WorldcatAccessToken</code> object:
<div class="language-python highlight"><span class="filename">WorldcatAccessToken with custom agent</span><pre><span></span><code><span class="n">token</span> <span class="o">=</span> <span class="n">WorldcatAccessToken</span><span class="p">(</span>
    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;my_WSKey&quot;</span><span class="p">,</span>
    <span class="n">secret</span><span class="o">=</span><span class="s2">&quot;my_secret&quot;</span><span class="p">,</span>
    <span class="n">scopes</span><span class="o">=</span><span class="s2">&quot;WorldCatMetadataAPI&quot;</span><span class="p">,</span>
    <span class="n">agent</span><span class="o">=</span><span class="s2">&quot;my_app/1.0.0&quot;</span>
<span class="p">)</span>
</code></pre></div></p>
<h4 id="automatic-token-refresh">Automatic Token Refresh</h4>
<p>All requests made within a <code>MetadataSession</code> have a built-in access token auto-refresh feature. While a session is open, the current token will be checked for expiration before sending a request. If the token has expired, a new token will be obtained and the <code>MetadataSession</code> will continue to send requests.</p>
<h4 id="retry-failed-requests">Retry Failed Requests</h4>
<p>Users can configure a <code>MetadataSession</code> to automatically retry failed requests. This functionality is customizable with the <code>totalRetries</code>, <code>backoffFactor</code>, <code>statusForcelist</code>, and <code>allowedMethods</code> arguments. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended that users only allow for automatic retries on timeouts or other server errors. Users should also keep their automatic retries as low as possible in order to not overburden the web service. Users should not set up automatic retries for authentication (401, 403) or malformed request errors (400).</p>
</div>
<p><div class="language-python highlight"><span class="filename">MetadataSession with Retries</span><pre><span></span><code><span class="k">with</span> <span class="n">MetadataSession</span><span class="p">(</span>
    <span class="n">authorization</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">totalRetries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">backoffFactor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">statusForcelist</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">502</span><span class="p">,</span> <span class="mi">503</span><span class="p">,</span> <span class="mi">504</span><span class="p">],</span>
    <span class="n">allowedMethods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">session</span><span class="o">.</span><span class="n">bib_get</span><span class="p">(</span><span class="s2">&quot;12334&quot;</span><span class="p">)</span>
</code></pre></div>
Bookops-Worldcat will return a <code>RetryError</code> if a request is attempted up to the value of <code>totalRetries</code> and still fails.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../local/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Search and Manage Local Data">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Search and Manage Local Data
              </div>
            </div>
          </a>
        
        
          
          <a href="../about/" class="md-footer__link md-footer__link--next" aria-label="Next: About BookOps">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                About BookOps
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.tabs.link", "content.code.copy", "content.code.annotate", "navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "navigation.sections", "navigation.expand"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
    
  </body>
</html>